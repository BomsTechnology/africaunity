import{r as i,p as o,q as h}from"./app.4a599ac6.js";function b(){const c=i([]),p=i([]),u=i([]),r=i(""),a=i(0),g=async s=>{r.value="";try{a.value=!0;let e=await o.get("/api/chat/conversations/user/"+s,{headers:{Authorization:`Bearer ${localStorage.token}`}});c.value=await v(e.data.data),a.value=!1}catch(e){e.response.status==401&&(h.push({name:"login",params:{redirect:"not-login"}}),window.localStorage.removeItem("token"),window.localStorage.removeItem("user"))}},f=async s=>{r.value="";try{a.value=!0;let t=(await o.get("/api/chat/folders/user/"+s,{headers:{Authorization:`Bearer ${localStorage.token}`}})).data.data;for(let n=0;n<t.length;n++)t[n].conversations=await v(t[n].conversations);p.value=t,a.value=!1}catch(e){e.response.status==401&&(h.push({name:"login",params:{redirect:"not-login"}}),window.localStorage.removeItem("token"),window.localStorage.removeItem("user"))}},m=async s=>{r.value="";try{a.value=!0;let e=await o.post("/api/chat/conversations",s,{headers:{Authorization:`Bearer ${localStorage.token}`}});u.value=e.data.data,a.value=!1}catch(e){if(e.response.status==422){a.value=0;for(const t in e.response.data.errors)r.value+=e.response.data.errors[t][0]+`
`}}},y=async s=>{r.value="";try{a.value=!0;let e=await o.post("/api/chat/folders",s,{headers:{Authorization:`Bearer ${localStorage.token}`}});a.value=!1}catch(e){if(e.response.status==422){a.value=0;for(const t in e.response.data.errors)r.value+=e.response.data.errors[t][0]+`
`}}},w=async s=>{r.value="";try{a.value=!0,await o.post("/api/chat/folders/conversations",s,{headers:{Authorization:`Bearer ${localStorage.token}`}}),a.value=!1}catch(e){a.value=0,e.response.status=="500"&&(r.value="Impossible de supprimer ce chat")}},k=async s=>{r.value="";try{a.value=!0;let e=await o.post("/api/chat/messages",s,{headers:{Authorization:`Bearer ${localStorage.token}`}});u.value=e.data.data,a.value=!1}catch(e){if(e.response.status==422){a.value=0;for(const t in e.response.data.errors)r.value+=e.response.data.errors[t][0]+`
`}}},S=async s=>{r.value="";try{let e=await o.post("/api/chat/report/messages",s,{headers:{Authorization:`Bearer ${localStorage.token}`}})}catch(e){if(e.response&&e.response.status==422){a.value=0;for(const t in e.response.data.errors)r.value+=e.response.data.errors[t][0]+`
`}}},z=async s=>{r.value="";try{let e=await o.post("/api/chat/isread",s,{headers:{Authorization:`Bearer ${localStorage.token}`}});c.value=await v(e.data.data)}catch(e){if(e.response.status==422){a.value=0;for(const t in e.response.data.errors)r.value+=e.response.data.errors[t][0]+`
`}}},A=async(s,e)=>{r.value="";try{a.value=!0,await o.post("/api/chat/messages/"+s,e,{headers:{Authorization:`Bearer ${localStorage.token}`,"Content-Type":"multipart/form-data"}}),a.value=!1}catch(t){if(a.value=0,t.response.status==422)for(const n in t.response.data.errors)r.value+=t.response.data.errors[n][0]+`	
`}},B=async(s,e)=>{r.value="";try{a.value=!0,await o.post("/api/chat/conversations/"+s+"/delete",e,{headers:{Authorization:`Bearer ${localStorage.token}`}}),a.value=!1}catch(t){a.value=0,t.response.status=="500"&&(r.value="Impossible de supprimer cette conversation")}},$=async s=>{r.value="";try{a.value=!0,await o.delete("/api/chat/folders/"+s,{headers:{Authorization:`Bearer ${localStorage.token}`}}),a.value=!1}catch(e){a.value=0,e.response.status=="500"&&(r.value="Impossible de supprimer ce Dossier")}},C=async(s,e)=>{r.value="";try{a.value=!0,await o.post("/api/chat/messages/"+s+"/delete",e,{headers:{Authorization:`Bearer ${localStorage.token}`}}),a.value=!1}catch(t){a.value=0,t.response.status=="500"&&(r.value="Impossible de supprimer ce Message")}},I=async(s,e)=>{r.value="";try{a.value=!0,await o.post("/api/chat/folders/conversations/"+s,{conversation_id:e},{headers:{Authorization:`Bearer ${localStorage.token}`}}),a.value=!1}catch(t){a.value=0,t.response.status=="500"&&(r.value="Impossible de retirer cette conversation")}},v=async s=>{let e=s.filter(l=>l.messages.length>0),t=s.filter(l=>l.messages.length==0);return e.sort((l,d)=>{let M=new Date(d.messages[d.messages.length-1].date).getTime(),F=new Date(l.messages[l.messages.length-1].date).getTime();return M-F}),e.concat(t)};return{conversations:c,conversation:u,errors:r,loading:a,deleteMessage:C,updateMessage:A,removeCoversationToFolder:I,destroyCoversationFolder:$,addConversationToFolder:w,folders:p,isRead:z,createMessage:k,destroyConversation:B,getConversationsUser:g,createConversation:m,getConversationsFolderUser:f,createConversationFolder:y,reportMessage:S}}export{b as u};
