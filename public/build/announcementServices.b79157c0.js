import{r as l,n as r,p as g}from"./app.1097d858.js";function F(){const s=l([]),i=l([]),t=l(""),n=l(0),v=l(!1),p=l(1),d=e=>Object.entries(e).reduce((a,[o,u])=>(Array.isArray(u)?u.forEach(c=>a.append(`${o}[]`,c.file)):a.append(o,u),a),new FormData);return{filterAnnouncements:async e=>{t.value="";try{n.value=3;let a=await r.post("/api/announcements-filter",e,{headers:{Authorization:`Bearer ${localStorage.token}`}});s.value=a.data.data,n.value=!1}catch(a){a.response.status==401&&(g.push({name:"login",params:{redirect:"not-login"}}),window.localStorage.removeItem("token"),window.localStorage.removeItem("user"))}},isAll:v,page:p,announcements:s,announcement:i,errors:t,loading:n,getAnnouncements:async()=>{t.value="",n.value=!0;let e=await r.get("/api/announcements?page="+p.value,{headers:{Authorization:`Bearer ${localStorage.token}`}});p.value==1?s.value=e.data.data:s.value=s.value.concat(e.data.data),n.value=!1,e.data.data.length==0&&(v.value=!0)},getAnnouncement:async e=>{t.value="",n.value=!0;let a=await r.get("/api/announcements/"+e,{headers:{Authorization:`Bearer ${localStorage.token}`}});n.value=0,i.value=a.data.data},createAnnouncement:async e=>{t.value="";try{n.value=!0;let a=await r.post("/api/announcements",d(e),{headers:{Authorization:`Bearer ${localStorage.token}`,"Content-Type":"multipart/form-data"}});n.value=!1}catch(a){if(a.response.status==422){n.value=0;for(const o in a.response.data.errors)t.value+=a.response.data.errors[o][0]+`
`}}},updateAnnouncement:async(e,a)=>{t.value="";try{n.value=!0;let o=e.image.filter(m=>typeof m=="string"),u=e.image.filter(m=>typeof m!="string");e.image=u;let c=d(e);c.append("old_files",o),c.append("_method","PUT");let B=await r.post("/api/announcements/"+i.value.id,c,{headers:{Authorization:`Bearer ${localStorage.token}`,"Content-Type":"multipart/form-data"}});n.value=!1}catch(o){if(n.value=0,o.response.status==422)for(const u in o.response.data.errors)t.value+=o.response.data.errors[u][0]+`	
`}},destroyAnnouncement:async e=>{t.value="";try{n.value=!0,await r.delete(`/api/announcements/${JSON.stringify(e)}`,{headers:{Authorization:`Bearer ${localStorage.token}`}}),n.value=!1}catch(a){n.value=0,a.response.status=="500"&&(t.value="Impossible de supprimer ce announcement")}},getAnnouncementsUser:async e=>{t.value="",n.value=!0;let a=await r.get("/api/announcements-user/"+e,{headers:{Authorization:`Bearer ${localStorage.token}`}});s.value=a.data.data,n.value=!1},getAnnouncementsUniversity:async e=>{t.value="",n.value=!0;let a=await r.get("/api/announcements-university/"+e,{headers:{Authorization:`Bearer ${localStorage.token}`}});s.value=a.data.data,n.value=!1},getAnnouncement2:async e=>{t.value="",n.value=!0;let a=await r.get("/api/announcements2/"+e,{headers:{Authorization:`Bearer ${localStorage.token}`}});n.value=0,i.value=a.data.data}}}export{F as u};
