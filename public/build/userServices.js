var o=(l,i,t)=>new Promise((a,p)=>{var d=u=>{try{f(t.next(u))}catch(h){p(h)}},y=u=>{try{f(t.throw(u))}catch(h){p(h)}},f=u=>u.done?a(u.value):Promise.resolve(u.value).then(d,y);f((t=t.apply(l,i)).next())});import{r as c,p as n,q as g}from"./app.js";function J(){const l=c([]),i=c([]),t=c(""),a=c(0),p=c(!1),d=c(1);return{filterUserConversation:s=>o(this,null,function*(){t.value="";try{a.value=!0;let e=yield n.get("/api/users-filter/conversation/"+s,{headers:{Authorization:`Bearer ${localStorage.token}`}});l.value=e.data.data,a.value=!1}catch(e){e.response.status==401&&(g.push({name:"login",params:{redirect:"not-login"}}),window.localStorage.removeItem("token"),window.localStorage.removeItem("user"))}}),isAll:p,page:d,users:l,user:i,errors:t,loading:a,deleteUserData:s=>o(this,null,function*(){t.value="";try{a.value=!0;let e=yield n.post("/api/users-delete-data",s,{headers:{Authorization:`Bearer ${localStorage.token}`}});a.value=!1}catch(e){if(a.value=0,e.response.status==422)for(const r in e.response.data.errors)t.value+=e.response.data.errors[r][0]+`	
`;else e.response.status==401&&(t.value=e.response.data.message)}}),getUsers:()=>o(this,null,function*(){try{t.value="",a.value=!0;let s=yield n.get("/api/users",{headers:{Authorization:`Bearer ${localStorage.token}`}});l.value=s.data.data,a.value=!1}catch(s){s.response.status==401&&(g.push({name:"login",params:{redirect:"not-login"}}),window.localStorage.removeItem("token"),window.localStorage.removeItem("user"))}}),getUser:s=>o(this,null,function*(){t.value="";try{a.value=!0;let e=yield n.get("/api/users/"+s,{headers:{Authorization:`Bearer ${localStorage.token}`}});a.value=0,i.value=e.data.data}catch(e){e.response.status==401&&(g.push({name:"login",params:{redirect:"not-login"}}),window.localStorage.removeItem("token"),window.localStorage.removeItem("user"))}}),createUser:s=>o(this,null,function*(){t.value="";try{a.value=!0,yield n.post("/api/users",s,{headers:{Authorization:`Bearer ${localStorage.token}`}}),a.value=!1}catch(e){if(e.response.status==422){a.value=0;for(const r in e.response.data.errors)t.value+=e.response.data.errors[r][0]+`
`}}}),updateUser:(s,e)=>o(this,null,function*(){t.value="";try{a.value=!0;let r=yield n.post("/api/users/"+s,e,{headers:{Authorization:`Bearer ${localStorage.token}`,"Content-Type":"multipart/form-data"}});a.value=!1,localStorage.user=JSON.stringify(r.data.data),location.reload()}catch(r){if(a.value=0,r.response.status==422)for(const v in r.response.data.errors)t.value+=r.response.data.errors[v][0]+`	
`}}),destroyUser:s=>o(this,null,function*(){t.value="";try{return a.value=!0,yield n.delete(`/api/users/${JSON.stringify(s)}`,{headers:{Authorization:`Bearer ${localStorage.token}`}}),a.value=!1,!0}catch(e){a.value=0,t.value="Impossible de supprimer ce user"}}),updatePasswordUser:(s,e)=>o(this,null,function*(){t.value="";try{a.value=!0,yield n.put("/api/users-change-password/"+s,e,{headers:{Authorization:`Bearer ${localStorage.token}`}}),a.value=!1}catch(r){if(a.value=0,r.response.status==422)for(const v in r.response.data.errors)t.value+=r.response.data.errors[v][0]+`	
`;else r.response.status==401&&(t.value=r.response.data.message)}}),updateStatusUser:(s,e)=>o(this,null,function*(){t.value="";try{a.value=!0;let r=yield n.put("/api/users-change-status/"+s,e,{headers:{Authorization:`Bearer ${localStorage.token}`}});a.value=!1,localStorage.user=JSON.stringify(r.data.data)}catch(r){if(a.value=0,r.response.status==422)for(const v in r.response.data.errors)t.value+=r.response.data.errors[v][0]+`	
`}}),destroyUserFront:s=>o(this,null,function*(){t.value="";try{a.value=!0;let e=yield n.post("/api/users-delete-user",s,{headers:{Authorization:`Bearer ${localStorage.token}`}});a.value=!1}catch(e){if(a.value=0,e.response.status==422)for(const r in e.response.data.errors)t.value+=e.response.data.errors[r][0]+`	
`;else e.response.status==401&&(t.value=e.response.data.message)}}),getUsersType:s=>o(this,null,function*(){try{t.value="",a.value=!0;let e=yield n.get("/api/users-type/"+s+"?page="+d.value,{headers:{Authorization:`Bearer ${localStorage.token}`}});d.value==1?l.value=e.data.data:l.value=l.value.concat(e.data.data),a.value=!1,e.data.data.length==0&&(p.value=!0)}catch(e){e.response.status==401&&(g.push({name:"login",params:{redirect:"not-login"}}),window.localStorage.removeItem("token"),window.localStorage.removeItem("user"))}}),filterUsers:s=>o(this,null,function*(){t.value="";try{a.value=3;let e=yield n.post("/api/users-filter",s,{headers:{Authorization:`Bearer ${localStorage.token}`}});l.value=e.data.data,a.value=!1}catch(e){e.response.status==401&&(g.push({name:"login",params:{redirect:"not-login"}}),window.localStorage.removeItem("token"),window.localStorage.removeItem("user"))}}),updateUser2:()=>o(this,null,function*(){t.value="";try{a.value=!0;let s=yield n.put("/api/users-update/"+i.value.id,i.value,{headers:{Authorization:`Bearer ${localStorage.token}`}});a.value=!1}catch(s){if(a.value=0,s.response.status==422)for(const e in s.response.data.errors)t.value+=s.response.data.errors[e][0]+`	
`}})}}export{J as u};
