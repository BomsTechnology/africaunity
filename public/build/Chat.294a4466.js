import{d as s,e as a,f as t,r as x,I as C,L,m as Ue,K as I,h as i,g,M as ue,t as p,F as f,x as w,N as lt,a as Fe,o as at,O as oe,c as Se,l as A,w as ot,j as nt,P as rt,k as h,n as v,Q as Be}from"./app.4a599ac6.js";import{_ as it,r as dt,a as Ee,b as Le,c as De}from"./StartConversation.6bc13d98.js";import{u as ce}from"./chatServices.15a7a6b0.js";import{r as ne}from"./UserCircleIcon.ec428794.js";import{r as re}from"./PhotoIcon.6207048b.js";import{r as ie}from"./UserGroupIcon.93c0f1fc.js";import{r as Q}from"./TrashIcon.2cb27c3c.js";import{r as ut}from"./PencilSquareIcon.68e81e57.js";import{r as He}from"./FaceSmileIcon.bb598825.js";import{r as ct}from"./XMarkIcon.835048f1.js";import"./userServices.beecf26d.js";function ht(k,j){return s(),a("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[t("path",{"fill-rule":"evenodd",d:"M10.5 6a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zm0 6a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zm0 6a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0z","clip-rule":"evenodd"})])}function gt(k,j){return s(),a("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[t("path",{"fill-rule":"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z","clip-rule":"evenodd"})])}function X(k,j){return s(),a("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[t("path",{"fill-rule":"evenodd",d:"M19.5 21a3 3 0 003-3V9a3 3 0 00-3-3h-5.379a.75.75 0 01-.53-.22L11.47 3.66A2.25 2.25 0 009.879 3H4.5a3 3 0 00-3 3v12a3 3 0 003 3h15zM9 12.75a.75.75 0 000 1.5h6a.75.75 0 000-1.5H9z","clip-rule":"evenodd"})])}function pt(k,j){return s(),a("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[t("path",{"fill-rule":"evenodd",d:"M19.5 21a3 3 0 003-3V9a3 3 0 00-3-3h-5.379a.75.75 0 01-.53-.22L11.47 3.66A2.25 2.25 0 009.879 3H4.5a3 3 0 00-3 3v12a3 3 0 003 3h15zm-6.75-10.5a.75.75 0 00-1.5 0v2.25H9a.75.75 0 000 1.5h2.25v2.25a.75.75 0 001.5 0v-2.25H15a.75.75 0 000-1.5h-2.25V10.5z","clip-rule":"evenodd"})])}function de(k,j){return s(),a("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[t("path",{"fill-rule":"evenodd",d:"M18.97 3.659a2.25 2.25 0 00-3.182 0l-10.94 10.94a3.75 3.75 0 105.304 5.303l7.693-7.693a.75.75 0 011.06 1.06l-7.693 7.693a5.25 5.25 0 11-7.424-7.424l10.939-10.94a3.75 3.75 0 115.303 5.304L9.097 18.835l-.008.008-.007.007-.002.002-.003.002A2.25 2.25 0 015.91 15.66l7.81-7.81a.75.75 0 011.061 1.06l-7.81 7.81a.75.75 0 001.054 1.068L18.97 6.84a2.25 2.25 0 000-3.182z","clip-rule":"evenodd"})])}function Z(k,j){return s(),a("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[t("path",{"fill-rule":"evenodd",d:"M12 3.75a.75.75 0 01.75.75v6.75h6.75a.75.75 0 010 1.5h-6.75v6.75a.75.75 0 01-1.5 0v-6.75H4.5a.75.75 0 010-1.5h6.75V4.5a.75.75 0 01.75-.75z","clip-rule":"evenodd"})])}const ft={class:"fixed inset-0 z-40 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},mt={class:"flex min-h-screen items-end justify-center px-4 pt-4 pb-20 text-center sm:block sm:p-0"},bt=t("span",{class:"hidden sm:inline-block sm:h-screen sm:align-middle","aria-hidden":"true"},"\u200B",-1),vt={class:"inline-block transform overflow-hidden rounded-lg p-4 bg-white text-left align-middle shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg"},_t=t("h1",{class:"text-2xl font-bold text-black"}," Ajouter un dossier ",-1),yt=["onSubmit"],wt={class:"relative"},xt={class:"mt-5"},kt=["disabled"],Mt={key:0},Ct={key:1},$t={__name:"CreateConversationFolder",props:{open:Boolean,toogleModal:Function},emits:["folderCreated"],setup(k,{emit:j}){const{createConversationFolder:E,loading:T,getConversationsFolderUser:he,errors:K}=ce(),V=JSON.parse(localStorage.user),z=x(""),$=async()=>{await E({name:z.value,user_id:V.id}),j("folderCreated")};return(_,D)=>C((s(),a("div",ft,[t("div",mt,[t("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",style:{"backdrop-filter":"blur(5px)"},"aria-hidden":"true",onClick:D[0]||(D[0]=(...F)=>k.toogleModal&&k.toogleModal(...F))}),bt,t("div",vt,[_t,t("form",{onSubmit:Ue($,["prevent"]),class:"relative mt-5"},[t("div",wt,[C(t("input",{type:"text","onUpdate:modelValue":D[1]||(D[1]=F=>z.value=F),class:"block w-full rounded-sm border border-gray-300 bg-gray-50 p-2.5 text-md text-gray-900 focus:border-blue-500 focus:ring-blue-500",placeholder:"Nom du dossier",required:""},null,512),[[I,z.value]])]),t("div",xt,[t("button",{type:"submit",disabled:i(T),class:"text-md w-full rounded bg-primary-blue px-6 py-3 leading-5 text-white focus:outline-none"},[i(T)==1?(s(),a("span",Mt,[g(ue,{size:"small"})])):(s(),a("span",Ct,p(_.$t("save")),1))],8,kt)])],40,yt)])])],512)),[[L,k.open]])}},jt={class:"fixed inset-0 z-40 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},zt={class:"flex min-h-screen items-end justify-center px-4 pt-4 pb-20 text-center sm:block sm:p-0"},Ft=t("span",{class:"hidden sm:inline-block sm:h-screen sm:align-middle","aria-hidden":"true"},"\u200B",-1),St={class:"inline-block transform overflow-hidden rounded-lg bg-white text-left align-middle shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg"},Bt={class:"relative rounded-lg bg-white py-4"},Et=t("h1",{class:"text-2xl font-bold text-black mx-4"}," Selectionner un dossier ",-1),Lt={class:"max-h-96 min-h-[200px] overflow-y-auto mt-5"},Dt=["onClick"],Ht={key:1},Ut={__name:"AddConversationToFolder",props:{open:Boolean,toogleModal:Function,folders:Array,conversation:Object},emits:["conversationAdded"],setup(k,{emit:j}){const E=k,{loading:T,errors:he,addConversationToFolder:K}=ce(),V=async z=>{const $=z.conversations.filter(_=>_.id==E.conversation.id)[0];$||await K({conversation_id:E.conversation.id,conversation_folder_id:z.id}),j("conversationAdded",{isExist:!!$,folder:z})};return(z,$)=>C((s(),a("div",jt,[t("div",zt,[t("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true",style:{"backdrop-filter":"blur(5px)"},onClick:$[0]||($[0]=(..._)=>k.toogleModal&&k.toogleModal(..._))}),Ft,t("div",St,[t("div",Bt,[Et,t("div",Lt,[k.folders.length!=[]?(s(!0),a(f,{key:0},w(k.folders,_=>(s(),a("button",{type:"button",key:_.id,onClick:D=>V(_),class:"cursor-pointer block w-full text-xl text-left bg-white px-6 py-2 hover:bg-gray-100"},p(_.name),9,Dt))),128)):(s(),a("div",Ht,[g(lt)]))])])])])],512)),[[L,k.open]])}};const At={class:"mx-auto w-full bg-white p-4 lg:px-20 xl:w-[90%]"},Tt={class:"relative h-full w-full overflow-x-auto sm:rounded-lg"},Rt={class:"relative flex h-[500px] w-full rounded-lg bg-white shadow-lg md:h-[700px]"},Vt={key:0,class:"w-full py-4"},Ot={class:"relative mx-2"},It={class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},Kt={class:"mt-2 w-full px-2 py-2"},Nt={class:"no-scrollbar overflow-x-auto overflow-y-hidden"},qt={class:"content items-scretch flex justify-start border-b"},Yt=t("span",null,"Tous",-1),Jt=[Yt],Pt=["onClick"],Wt={class:"flex flex-shrink-0 items-center justify-center"},Gt={class:"grow overflow-y-auto"},Qt=["onClick"],Xt={key:0,class:"group relative flex h-24 w-full cursor-pointer items-center space-x-2 border-b p-3"},Zt={class:"h-12 w-12 overflow-hidden rounded lg:h-16 lg:w-16"},es=["src"],ts={class:"flex-grow"},ss={class:"flex w-full justify-between"},ls={class:"whitespace-normal break-words text-base font-bold"},as={key:0},os={key:0,class:"text-xs"},ns={class:"flex w-full items-center justify-between"},rs={class:"flex items-center gap-1 whitespace-normal text-sm font-light"},is={class:"flex w-full items-center justify-start gap-0.5 overflow-hidden overflow-ellipsis"},ds={key:0},us={key:1},cs={key:0},hs={key:0,class:"flex h-6 w-6 items-center justify-center rounded-full bg-primary-blue text-sm font-light text-white"},gs=["onClick"],ps={key:1,class:"group flex h-24 w-full cursor-pointer items-center space-x-2 border-b p-3 hover:bg-gray-50"},fs={class:"h-12 w-12 overflow-hidden rounded lg:h-16 lg:w-16"},ms=["src"],bs={class:"flex-grow"},vs={class:"flex w-full justify-between"},_s={class:"whitespace-normal break-words text-base font-bold"},ys={key:0},ws={key:1},xs={key:0,class:"text-xs"},ks={class:"flex w-full items-center justify-between"},Ms={class:"whitespace-normal text-sm font-light text-gray-800"},Cs={class:"w-full overflow-hidden overflow-ellipsis"},$s={key:0},js={key:0,class:"flex h-6 w-6 items-center justify-center rounded-full bg-primary-blue text-sm font-light text-white"},zs=["onClick"],Fs=t("p",{class:"text-sm"},"Supprimer ce dossier",-1),Ss={class:"relative hidden w-full max-w-[30%] flex-col border-x py-4 lg:flex"},Bs={class:"relative mx-2"},Es={class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},Ls={class:"mt-2 w-full px-2 py-2"},Ds={class:"content items-scretch flex justify-start border-b"},Hs=t("span",null,"Tous",-1),Us=[Hs],As=["onClick"],Ts={class:"flex flex-shrink-0 items-center justify-center"},Rs={class:"grow overflow-y-auto"},Vs=["onClick"],Os={key:0,class:"group relative flex h-24 w-full cursor-pointer items-center space-x-2 border-b p-3"},Is={class:"h-12 w-12 overflow-hidden rounded lg:h-16 lg:w-16"},Ks=["src"],Ns={class:"flex-grow"},qs={class:"flex w-full justify-between"},Ys={class:"whitespace-normal break-words text-base font-bold"},Js={key:0},Ps={key:0,class:"text-xs"},Ws={class:"flex w-full items-center justify-between"},Gs={class:"flex items-center gap-1 whitespace-normal text-sm font-light"},Qs={class:"flex w-full items-center justify-start gap-0.5 overflow-hidden overflow-ellipsis"},Xs={key:0},Zs={key:1},el={key:0},tl={key:0,class:"flex h-6 w-6 items-center justify-center rounded-full bg-primary-blue text-sm font-light text-white"},sl=["onClick"],ll={key:1,class:"group flex h-24 w-full cursor-pointer items-center space-x-2 border-b p-3 hover:bg-gray-50"},al={class:"h-12 w-12 overflow-hidden rounded lg:h-16 lg:w-16"},ol=["src"],nl={class:"flex-grow"},rl={class:"flex w-full justify-between"},il={class:"whitespace-normal break-words text-base font-bold"},dl={key:0},ul={key:1},cl={key:0,class:"text-xs"},hl={class:"flex w-full items-center justify-between"},gl={class:"whitespace-normal text-sm font-light text-gray-800"},pl={class:"w-full overflow-hidden overflow-ellipsis"},fl={key:0},ml={key:0,class:"flex h-6 w-6 items-center justify-center rounded-full bg-primary-blue text-sm font-light text-white"},bl=["onClick"],vl=t("p",{class:"text-sm"},"Supprimer ce dossier",-1),_l={class:"bg-chat relative flex w-full grow flex-col border-r"},yl={key:0,class:"relative flex h-24 w-full items-center justify-between space-x-2 border-b bg-white p-3"},wl={class:"flex items-center gap-2"},xl={class:"h-12 w-12 overflow-hidden rounded-full drop-shadow-md"},kl=["src"],Ml=["src"],Cl={class:"whitespace-normal text-sm font-bold"},$l={key:0},jl={key:0},zl={key:1},Fl={class:"text-[11px]"},Sl={key:0},Bl=t("p",{class:"text-sm"},"Ajouter \xE0 un dossier",-1),El=t("p",{class:"text-sm"},"Supprimer",-1),Ll={class:"flex min-h-0 w-full flex-col items-end justify-end"},Dl=t("p",{class:"text-xs"},"Editer",-1),Hl=t("p",{class:"text-xs"},"Signaler",-1),Ul=t("p",{class:"text-xs"},"Supprimer",-1),Al={class:"rounded bg-white px-2 py-1 text-center text-xs uppercase text-gray-700 shadow"},Tl=["onContextmenu"],Rl=["href","download"],Vl={style:{"backdrop-filter":"blur(5px)"},class:"absolute right-0 top-0 hidden items-center bg-white/50 p-2 text-primary-blue hover:bg-primary-blue/50 hover:text-black group-hover:flex"},Ol={class:"block"},Il=t("span",{class:"block"},"Telecharger",-1),Kl=["src"],Nl={class:"absolute bottom-0 w-full bg-white/50 p-2 text-xs"},ql={class:"block break-words text-xs font-medium"},Yl={class:"mt-1 block break-words text-[11px]"},Jl=["href","download"],Pl={style:{"backdrop-filter":"blur(5px)"},class:"absolute right-0 top-0 hidden items-center bg-white/50 p-2 text-primary-blue hover:bg-primary-blue/50 hover:text-black group-hover:flex"},Wl={class:"block"},Gl=t("span",{class:"block"},"Telecharger",-1),Ql={class:"flex h-20 w-32 items-center justify-center bg-gray-500 font-bold uppercase text-white"},Xl={class:"flex grow flex-col items-start justify-start p-2"},Zl={class:"break-words text-xs"},ea={class:"break-words text-[11px]"},ta={class:"text-md"},sa={class:"mt-2 flex items-center gap-1 text-right text-xs font-light"},la={class:"block"},aa={key:0,class:"block italic"},oa={key:0,class:"relative mt-2"},na=["onUpdate:modelValue","rows"],ra={key:0},ia={key:1},da={class:"mx-auto w-full md:max-w-[70%]"},ua={class:"relative flex items-end gap-2 rounded-lg py-2 px-3"},ca=["disabled"],ha=["disabled"],ga={class:"relative flex w-full flex-col"},pa={class:"h-20 w-32"},fa=["src"],ma={key:1,class:"flex h-full w-full items-center justify-center bg-gray-500 text-white"},ba=t("span",null,"File",-1),va=[ba],_a={class:"flex grow flex-col items-start justify-start p-2"},ya={class:"break-words text-xs"},wa={class:"break-words text-[11px]"},xa=t("emoji-picker",{locale:"fr"},null,-1),ka=[xa],Ma=["rows","onKeydown","disabled"],Ca=["disabled"],$a={key:0},ja={key:1},za={class:"fixed top-0 left-0 z-20 flex h-screen w-screen items-center justify-center",style:{"backdrop-filter":"blur(5px)"}},Fa={class:"min-w-[300px] rounded bg-white p-4 shadow"},Sa=t("p",{class:""},"Supprimer le message ?",-1),Ba={class:"mt-5 flex flex-col items-end justify-end gap-3"},Ka={__name:"Chat",setup(k){const{createConversation:j,loading:E,errors:T,conversation:he,createMessage:K,destroyConversation:V,updateMessage:z,getConversationsUser:$,conversations:_,isRead:D,folders:F,getConversationsFolderUser:H,removeCoversationToFolder:Ae,destroyCoversationFolder:Te,deleteMessage:Re,reportMessage:Ve}=ce(),N=x(null),ge=x(null),pe=x(null),m=x(null),M=x(null),ee=x(null),fe=x(null),q=x(null),me=x(1),be=x(1),U=x(""),te=x(!1),Y=x(!1),J=x(!1),d=x(null),y=x(null),u=x(null);u.value=JSON.parse(localStorage.user);const r=Fe({chat:!0,conversation:!1,emoji:!1,option:!1,optionMessage:!1,editMessage:!1,deleteMessage:!1}),c=Fe({message:"",user_id:u.value.id,conversation_id:"",attachement:null,attachement_path:"",attachement_name:"",attachement_size:"",type:"text"});at(async()=>{await $(u.value.id),M.value=_.value,await H(u.value.id),document.onkeydown=function(l){l=l||window.event,l.keyCode==27&&(r.emoji?r.emoji=!1:r.editMessage?(r.editMessage=!1,r.optionMessage=!1):r.optionMessage?r.optionMessage=!1:r.option?r.option=!1:d.value?(d.value=null,O()):m.value=null)},ee.value.querySelector("emoji-picker").addEventListener("emoji-click",l=>{r.editMessage?y.value.message+=`${l.detail.unicode} `:c.message+=`${l.detail.unicode} `}),window.Echo.channel(`chat.${u.value.id}`).listen(".chat-update",async l=>{ae(),st()})}),oe(ee,()=>{r.emoji=!1}),oe(fe,()=>{r.option=!1}),oe(q,()=>{r.optionMessage=!1});const O=(l=!1)=>{l||(c.message="",c.conversation_id=""),c.attachement="",c.attachement_path="",c.attachement_name="",c.attachement_size="",c.type="text",r.editMessage=!1,y.value=null};function ve(l){switch(l){case"chat":r.conversation=!1,r.chat=!0;break;case"conversation":r.chat=!1,r.conversation=!0;break}}const P=()=>{te.value=!te.value},se=()=>{J.value=!J.value},_e=()=>{Y.value=!Y.value},Oe=async()=>{await H(u.value.id),J.value=!1},Ie=async l=>{r.option=!1,M.value=l.folder.conversations,m.value=l.folder,Y.value=!1,l.isExist||await H(u.value.id).then(o=>{let e=F.value.filter(b=>b.id==l.folder.id)[0];M.value=e.conversations,m.value=e})},Ke=async l=>{P();let o=_.value.filter(e=>e.users.find(b=>b.id==l.id))[0];o?d.value=o:(await j({users:[u.value.id,l.id]}),await $(u.value.id),ae()),O()},Ne=()=>{r.editMessage=!0,setTimeout(()=>{$e(pe.value[0].value)},100)},ye=async()=>{const l=d.value.users.filter(o=>o.id!=u.value.id)[0];y.value.is_edit=!0,r.editMessage=!1,z(y.value.id,{text:y.value.message,received_id:l.id})},we=async l=>{r.deleteMessage=!1;const o=d.value.messages.indexOf(y.value);if(o>=0){const e=d.value.users.filter(b=>b.id!=u.value.id)[0];d.value.messages.splice(o,1),await Re(y.value.id,{for:l,user_id:u.value.id,received_id:e.id})}},qe=async()=>{r.optionMessage=!1,await Ve({conversation_id:d.value.id,message_id:y.value.id}),alert("Report sucess")},Ye=async()=>{r.optionMessage=!1,r.deleteMessage=!0},Je=async()=>{_e(),r.option=!1},W=async l=>{if(confirm("Are you sure you want to remove this conversation in folder?")){const o=m.value.conversations.indexOf(l);o>=0&&(m.value.conversations.splice(o,1),await Ae(m.value.id,l.id),await H(u.value.id))}},xe=async()=>{confirm("Are you sure you want to delete this folder?")&&(await Te(m.value.id),M.value=_.value,m.value=null,await H(u.value.id))},Pe=async()=>{confirm("Are you sure you want to delete this conversation?")&&(r.option=!1,await V(d.value.id,{user_id:u.value.id}),d.value=null,await $(u.value.id),await H(u.value.id),m.value==null?M.value=_.value:(m.value=F.value.filter(l=>l.id===m.value.id)[0],M.value=m.value.conversations))},G=Se(()=>M.value?M.value.filter(l=>l.users.some(o=>o.id!=u.value.id&&(o.firstname.toLowerCase().includes(U.value.toLowerCase())||o.lastname.toLowerCase().includes(U.value.toLowerCase())||o.email.toLowerCase().includes(U.value.toLowerCase())))):[]),ke=Se(()=>{let l={};return d.value.messages.forEach(o=>{l[`${B(o.date,!0)}`]||(l[`${B(o.date,!0)}`]=[]),l[`${B(o.date,!0)}`].push(o)}),l}),le=l=>{M.value=l.conversations,m.value=l};function Me(l){d.value=l,c.conversation_id=l.id,O();const o=d.value.users.filter(e=>e.id!=u.value.id)[0];D({conversation_id:d.value.id,user_id:u.value.id,received_id:o.id}),ve("chat")}async function Ce(){if(d.value&&!E.value&&(c.message||c.attachement)){c.conversation_id=d.value.id;const l={id:new Date().getTime(),user_id:u.value.id,user:u.value,is_send:!1,is_read:!1,date:Date.now(),attachement_path:c.attachement_path,attachement_name:c.attachement_name,message:c.message,type:c.type,conversation_id:c.conversation_id};_.value.filter(b=>b.id===d.value.id)[0].messages.push(l),le.value&&d.value.messages.push(l);const o=d.value.users.filter(b=>b.id!=u.value.id)[0];let e=new FormData;e.append("received_id",o.id),e.append("user_id",u.value.id),e.append("conversation_id",c.conversation_id),e.append("attachement",c.attachement),e.append("attachement_path",c.attachement_path),e.append("attachement_name",c.attachement_name),e.append("attachement_size",c.attachement_size),e.append("type",c.type),e.append("message",c.message),O(),await K(e),ae()}}function B(l,o,e=!1){l=new Date(l);const b=new Date,n=Math.round((b-l)/(1e3*60*60*24)),R={weekday:"long",year:"numeric",month:"long",day:"numeric"},S=["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"];return n===0?o?"Aujourd'hui":`${l.getHours()>9?l.getHours():"0"+l.getHours()}:${l.getMinutes()>9?l.getMinutes():"0"+l.getMinutes()}`:n===1?o||e?"Hier":`${l.getHours()>9?l.getHours():"0"+l.getHours()}:${l.getMinutes()>9?l.getMinutes():"0"+l.getMinutes()}`:n>1&&n<7?o||e?S[l.getDay()]:`${l.getHours()>9?l.getHours():"0"+l.getHours()}:${l.getMinutes()>9?l.getMinutes():"0"+l.getMinutes()}`:o&&!e?l.toLocaleDateString("fr-FR",R):!o&&e?l.toLocaleDateString("fr-FR"):`${l.getHours()>9?l.getHours():"0"+l.getHours()}:${l.getMinutes()>9?l.getMinutes():"0"+l.getMinutes()}`}const We=l=>{l.preventDefault();const o=l.currentTarget,e=l.deltaY;o.scrollLeft+=e},Ge=l=>{if(l.shiftKey&&l.key==="Enter"){l.preventDefault();const o=l.target,e=o.selectionStart,b=o.selectionEnd,n=o.value;o.value=n.substring(0,e)+`
`+n.substring(b),o.selectionStart=o.selectionEnd=e+1}else l.preventDefault(),Ce()},Qe=()=>{const o=(ge.value.value.match(/\n/g)||[]).length+1;me.value=o<10?o:10},Xe=l=>{if(l.shiftKey&&l.key==="Enter"){l.preventDefault();const o=l.target,e=o.selectionStart,b=o.selectionEnd,n=o.value;o.value=n.substring(0,e)+`
`+n.substring(b),o.selectionStart=o.selectionEnd=e+1}else l.preventDefault(),ye()},$e=l=>{const o=(l.match(/\n/g)||[]).length+1;be.value=o<10?o:10},Ze=(l,o)=>{l.preventDefault(),r.editMessage||(q.value.style.left=`${l.clientX+10}px`,q.value.style.top=`${l.clientY+10}px`,r.option=!1,r.emoji=!1,y.value=o,r.optionMessage=!0)},et=async l=>{const o=l.target.files[0];c.type="image",c.attachement=o,c.attachement_name=o.name,c.attachement_path=je(o),c.attachement_size=ze(o.size)},tt=async l=>{const o=l.target.files[0];c.type="file",c.attachement=o,c.attachement_name=o.name,c.attachement_path=je(o),c.attachement_size=ze(o.size)},st=()=>{N.value!=null&&N.value.scroll({top:N.value.scrollHeight,behavior:"smooth"})},ae=async()=>{await $(u.value.id),d.value&&(d.value=_.value.filter(l=>l.id===d.value.id)[0]),await H(u.value.id),m.value==null?M.value=_.value:(m.value=F.value.filter(l=>l.id===m.value.id)[0],M.value=m.value.conversations)};function je(l){return URL.createObjectURL(l)}function ze(l){const o=["Bytes","KB","MB","GB","TB"];if(l===0)return"n/a";const e=parseInt(Math.floor(Math.log(l)/Math.log(1024)),10);return e===0?`${l} ${o[e]})`:`${(l/1024**e).toFixed(1)} ${o[e]}`}return(l,o)=>(s(),a("div",At,[g(it,{open:te.value,toogleModal:P,conversationSelect:Ke},null,8,["open"]),g(Ut,{open:Y.value,toogleModal:_e,folders:i(F),conversation:d.value,onConversationAdded:Ie},null,8,["open","folders","conversation"]),g($t,{open:J.value,toogleModal:se,onFolderCreated:Oe},null,8,["open"]),i(T)!=""?(s(),A(rt,{key:0},{default:ot(()=>[nt(p(i(T)),1)]),_:1})):h("",!0),t("section",Tt,[t("div",Rt,[t("button",{onClick:o[0]||(o[0]=e=>ve("conversation")),type:"button",class:v([[r.conversation?" border-primary-blue bg-primary-blue ":"   border-primary-blue bg-white  text-primary-blue "],"absolute left-0 top-0 z-10 rounded-full border p-2 text-white shadow lg:hidden"])},[g(i(dt),{class:"h-5 w-5"})],2),r.conversation?(s(),a("div",Vt,[t("div",Ot,[t("div",It,[g(i(Ee),{class:"h-5 w-5 text-gray-500"})]),C(t("input",{type:"text","onUpdate:modelValue":o[1]||(o[1]=e=>U.value=e),class:"block w-full border border-gray-300 bg-gray-50 p-2.5 pl-10 text-sm text-gray-900 focus:border-primary-blue focus:ring-primary-blue",placeholder:"Rechercher...",required:""},null,512),[[I,U.value]])]),t("button",{type:"button",onClick:P,class:"absolute bottom-10 right-5 flex h-12 w-12 cursor-pointer items-center justify-center rounded-full bg-primary-blue p-2 text-white shadow-lg"},[g(i(Z),{class:"h-10 w-10"})]),t("div",Kt,[t("div",Nt,[t("div",qt,[t("button",{type:"button",onClick:o[2]||(o[2]=()=>{M.value=i(_),m.value=null}),class:v(["flex-shrink-0 cursor-pointer rounded-t-md py-2 px-4 text-center font-bold",[m.value?"border-gray-500 text-gray-500 hover:bg-gray-50":"border-b-2 border-primary-blue text-primary-blue hover:bg-blue-100"]])},Jt,2),(s(!0),a(f,null,w(i(F),e=>(s(),a("button",{type:"button",key:e.id,onClick:b=>le(e),class:v(["flex-shrink-0 cursor-pointer rounded-t-md py-2 px-4 text-center font-bold",[m.value&&m.value.id==e.id?"border-b-2 border-primary-blue text-primary-blue hover:bg-blue-100":"border-gray-500 text-gray-500 hover:bg-gray-50"]])},[t("span",null,p(e.name),1)],10,Pt))),128)),t("div",Wt,[t("button",{type:"button",onClick:se,class:"flex h-5 w-5 cursor-pointer items-center justify-center rounded-full bg-primary-blue p-0.5 text-white shadow-lg"},[g(i(Z),{class:"h-full w-full"})])])])])]),t("div",Gt,[i(G).length!=[]?(s(!0),a(f,{key:0},w(i(G),(e,b)=>(s(),a("div",{key:e.id,onClick:n=>Me(e),class:v([d.value&&d.value.id==e.id?"bg-primary-blue text-white":"text-gray-800 hover:bg-gray-100"])},[e.type=="conversation"?(s(),a("div",Xt,[t("div",Zt,[(s(!0),a(f,null,w(e.users,n=>(s(),a(f,null,[n.avatar&&n.id!=u.value.id?(s(),a("img",{key:0,src:n.avatar,class:"h-full w-full bg-cover object-cover",alt:""},null,8,es)):(s(),A(i(ne),{key:1,class:"h-full w-full"}))],64))),256))]),t("div",ts,[t("div",ss,[t("h1",ls,[(s(!0),a(f,null,w(e.users,n=>(s(),a(f,null,[n.id!=u.value.id?(s(),a("span",as,p(n.firstname),1)):h("",!0)],64))),256))]),e.messages.length>0?(s(),a("span",os,p(B(e.messages[e.messages.length-1].date,!1,!0)),1)):h("",!0)]),t("div",ns,[t("h6",rs,[e.messages.length>0?(s(),a(f,{key:0},[t("span",{class:v(["block h-2 w-2 flex-shrink-0 rounded-full",[e.messages[e.messages.length-1].is_send?e.messages[e.messages.length-1].is_read?"bg-green-500":"bg-gray-400  ":"bg-red-500"]])},null,2),t("span",is,[e.messages[e.messages.length-1].type=="file"?(s(),a("span",ds,[g(i(de),{class:"h-4 w-4"})])):e.messages[e.messages.length-1].type=="image"?(s(),a("span",us,[g(i(re),{class:"h-4 w-4"})])):h("",!0),t("span",null,p(e.messages[e.messages.length-1].message.length>35?e.messages[e.messages.length-1].message.substring(0,35)+"...":e.messages[e.messages.length-1].message),1)])],64)):(s(!0),a(f,{key:1},w(e.users,n=>(s(),a(f,null,[n.id!=u.value.id?(s(),a("span",cs,p(n.email),1)):h("",!0)],64))),256))]),e.nbUnRead>0?(s(),a("span",hs,[t("span",null,p(e.nbUnRead),1)])):h("",!0)])]),m.value?(s(),a("button",{key:0,onClick:n=>W(e),type:"button",class:"hidden h-6 w-6 items-center justify-center rounded-full text-red-300 hover:bg-red-100 hover:text-red-500 group-hover:flex"},[t("span",null,[g(i(X),{class:"h-4 w-4"})])],8,gs)):h("",!0)])):(s(),a("div",ps,[t("div",fs,[e.image?(s(),a("img",{key:0,src:e.image,class:"h-full w-full bg-cover object-cover",alt:""},null,8,ms)):(s(),A(i(ie),{key:1,class:"h-full w-full text-gray-500"}))]),t("div",bs,[t("div",vs,[t("h1",_s,[e.name?(s(),a("span",ys,p(e.name),1)):(s(),a("span",ws,"Sans nom"))]),e.messages.length>0?(s(),a("span",xs,p(B(e.messages[e.messages.length-1].date,!0,!0)),1)):h("",!0)]),t("div",ks,[t("h6",Ms,[e.messages.length>0?(s(),a(f,{key:0},[t("span",{class:v(["block h-2 w-2 flex-shrink-0 rounded-full",[e.messages[e.messages.length-1].is_send?e.messages[e.messages.length-1].is_read?"bg-green-500":"bg-gray-400  ":"bg-red-500"]])},null,2),t("span",Cs,p(e.messages[e.messages.length-1].message.length>35?e.messages[e.messages.length-1].message.substring(0,35)+"...":e.messages[e.messages.length-1].message),1)],64)):(s(!0),a(f,{key:1},w(e.users,(n,R)=>(s(),a("span",null,[R<3?(s(),a("span",$s,p(n.email)+", ",1)):h("",!0)]))),256))]),e.nbUnRead>0?(s(),a("span",js,[t("span",null,p(e.nbUnRead),1)])):h("",!0)])]),m.value?(s(),a("button",{key:0,onClick:n=>W(e),type:"button",class:"flex h-6 w-6 items-center justify-center rounded-full bg-red-100 text-red-500"},[t("span",null,[g(i(X),{class:"h-4 w-4"})])],8,zs)):h("",!0)]))],10,Qt))),128)):h("",!0),m.value?(s(),a("button",{key:1,type:"button",onClick:xe,class:"flex w-full items-center justify-center gap-1 p-2 text-red-500 opacity-25 hover:bg-red-100 hover:opacity-100"},[t("span",null,[g(i(Q),{class:"h-4 w-4"})]),Fs])):h("",!0)])])):h("",!0),t("div",Ss,[t("div",Bs,[t("div",Es,[g(i(Ee),{class:"h-5 w-5 text-gray-500"})]),C(t("input",{type:"text","onUpdate:modelValue":o[3]||(o[3]=e=>U.value=e),class:"block w-full border border-gray-300 bg-gray-50 p-2.5 pl-10 text-sm text-gray-900 focus:border-primary-blue focus:ring-primary-blue",placeholder:"Rechercher...",required:""},null,512),[[I,U.value]])]),t("button",{type:"button",onClick:P,class:"absolute bottom-10 right-5 flex h-12 w-12 cursor-pointer items-center justify-center rounded-full bg-primary-blue p-2 text-white shadow-lg"},[g(i(Z),{class:"h-10 w-10"})]),t("div",Ls,[t("div",{onWheel:We,class:"no-scrollbar overflow-x-auto overflow-y-hidden"},[t("div",Ds,[t("button",{type:"button",onClick:o[4]||(o[4]=()=>{M.value=i(_),m.value=null}),class:v(["flex-shrink-0 cursor-pointer rounded-t-md py-2 px-4 text-center font-bold",[m.value?"border-gray-500 text-gray-500 hover:bg-gray-50":"border-b-2 border-primary-blue text-primary-blue hover:bg-blue-100"]])},Us,2),(s(!0),a(f,null,w(i(F),e=>(s(),a("button",{type:"button",key:e.id,onClick:b=>le(e),class:v(["flex-shrink-0 cursor-pointer rounded-t-md py-2 px-4 text-center font-bold",[m.value&&m.value.id==e.id?"border-b-2 border-primary-blue text-primary-blue hover:bg-blue-100":"border-gray-500 text-gray-500 hover:bg-gray-50"]])},[t("span",null,p(e.name),1)],10,As))),128)),t("div",Ts,[t("button",{type:"button",onClick:se,class:"flex h-5 w-5 cursor-pointer items-center justify-center rounded-full bg-primary-blue p-0.5 text-white shadow-lg"},[g(i(Z),{class:"h-full w-full"})])])])],32)]),t("div",Rs,[i(G).length!=[]?(s(!0),a(f,{key:0},w(i(G),(e,b)=>(s(),a("div",{key:e.id,onClick:n=>Me(e),class:v([d.value&&d.value.id==e.id?"bg-primary-blue text-white":"text-gray-800 hover:bg-gray-100"])},[e.type=="conversation"?(s(),a("div",Os,[t("div",Is,[(s(!0),a(f,null,w(e.users,n=>(s(),a(f,null,[n.avatar&&n.id!=u.value.id?(s(),a("img",{key:0,src:n.avatar,class:"h-full w-full bg-cover object-cover",alt:""},null,8,Ks)):(s(),A(i(ne),{key:1,class:"h-full w-full"}))],64))),256))]),t("div",Ns,[t("div",qs,[t("h1",Ys,[(s(!0),a(f,null,w(e.users,n=>(s(),a(f,null,[n.id!=u.value.id?(s(),a("span",Js,p(n.firstname),1)):h("",!0)],64))),256))]),e.messages.length>0?(s(),a("span",Ps,p(B(e.messages[e.messages.length-1].date,!1,!0)),1)):h("",!0)]),t("div",Ws,[t("h6",Gs,[e.messages.length>0?(s(),a(f,{key:0},[t("span",{class:v(["block h-2 w-2 flex-shrink-0 rounded-full",[e.messages[e.messages.length-1].is_send?e.messages[e.messages.length-1].is_read?"bg-green-500":"bg-gray-400  ":"bg-red-500"]])},null,2),t("span",Qs,[e.messages[e.messages.length-1].type=="file"?(s(),a("span",Xs,[g(i(de),{class:"h-4 w-4"})])):e.messages[e.messages.length-1].type=="image"?(s(),a("span",Zs,[g(i(re),{class:"h-4 w-4"})])):h("",!0),t("span",null,p(e.messages[e.messages.length-1].message.length>35?e.messages[e.messages.length-1].message.substring(0,35)+"...":e.messages[e.messages.length-1].message),1)])],64)):(s(!0),a(f,{key:1},w(e.users,n=>(s(),a(f,null,[n.id!=u.value.id?(s(),a("span",el,p(n.email),1)):h("",!0)],64))),256))]),e.nbUnRead>0?(s(),a("span",tl,[t("span",null,p(e.nbUnRead),1)])):h("",!0)])]),m.value?(s(),a("button",{key:0,onClick:n=>W(e),type:"button",class:"hidden h-6 w-6 items-center justify-center rounded-full text-red-300 hover:bg-red-100 hover:text-red-500 group-hover:flex"},[t("span",null,[g(i(X),{class:"h-4 w-4"})])],8,sl)):h("",!0)])):(s(),a("div",ll,[t("div",al,[e.image?(s(),a("img",{key:0,src:e.image,class:"h-full w-full bg-cover object-cover",alt:""},null,8,ol)):(s(),A(i(ie),{key:1,class:"h-full w-full text-gray-500"}))]),t("div",nl,[t("div",rl,[t("h1",il,[e.name?(s(),a("span",dl,p(e.name),1)):(s(),a("span",ul,"Sans nom"))]),e.messages.length>0?(s(),a("span",cl,p(B(e.messages[e.messages.length-1].date,!0,!0)),1)):h("",!0)]),t("div",hl,[t("h6",gl,[e.messages.length>0?(s(),a(f,{key:0},[t("span",{class:v(["block h-2 w-2 flex-shrink-0 rounded-full",[e.messages[e.messages.length-1].is_send?e.messages[e.messages.length-1].is_read?"bg-green-500":"bg-gray-400  ":"bg-red-500"]])},null,2),t("span",pl,p(e.messages[e.messages.length-1].message.length>35?e.messages[e.messages.length-1].message.substring(0,35)+"...":e.messages[e.messages.length-1].message),1)],64)):(s(!0),a(f,{key:1},w(e.users,(n,R)=>(s(),a("span",null,[R<3?(s(),a("span",fl,p(n.email)+", ",1)):h("",!0)]))),256))]),e.nbUnRead>0?(s(),a("span",ml,[t("span",null,p(e.nbUnRead),1)])):h("",!0)])]),m.value?(s(),a("button",{key:0,onClick:n=>W(e),type:"button",class:"hidden h-6 w-6 items-center justify-center rounded-full text-red-300 hover:bg-red-100 hover:text-red-500 group-hover:flex"},[t("span",null,[g(i(X),{class:"h-4 w-4"})])],8,bl)):h("",!0)]))],10,Vs))),128)):h("",!0),m.value?(s(),a("button",{key:1,type:"button",onClick:xe,class:"flex w-full items-center justify-center gap-1 p-2 text-red-500 opacity-25 hover:bg-red-100 hover:opacity-100"},[t("span",null,[g(i(Q),{class:"h-4 w-4"})]),vl])):h("",!0)])]),C(t("div",_l,[d.value?(s(),a("div",yl,[t("div",wl,[t("div",xl,[d.value.type=="conversation"?(s(!0),a(f,{key:0},w(d.value.users,e=>(s(),a(f,null,[e.id!=u.value.id&&e.image?(s(),a("img",{key:0,src:e.image,class:"h-full w-full bg-cover object-cover",alt:""},null,8,kl)):(s(),A(i(ne),{key:1,class:"h-full w-full text-gray-800"}))],64))),256)):(s(),a(f,{key:1},[d.value.image?(s(),a("img",{key:0,src:d.value.image,class:"h-full w-full bg-cover object-cover",alt:""},null,8,Ml)):(s(),A(i(ie),{key:1,class:"h-full w-full text-gray-800"}))],64))]),t("div",null,[t("h1",Cl,[d.value.type=="conversation"?(s(!0),a(f,{key:0},w(d.value.users,e=>(s(),a(f,null,[e.id!=u.value.id?(s(),a("span",$l,p(e.firstname),1)):h("",!0)],64))),256)):(s(),a(f,{key:1},[d.value.name?(s(),a("span",jl,p(d.value.name),1)):(s(),a("span",zl,"Sans nom"))],64))]),t("p",Fl,[d.value.type=="conversation"?(s(!0),a(f,{key:0},w(d.value.users,e=>(s(),a(f,null,[e.id!=u.value.id?(s(),a("span",Sl,p(e.email),1)):h("",!0)],64))),256)):(s(!0),a(f,{key:1},w(d.value.users,e=>(s(),a("span",null,p(e.firstname)+",",1))),256))])])]),t("button",{type:"button",onClick:o[5]||(o[5]=()=>{r.editMessage||(r.option=!r.option)}),class:"rounded p-0.5 hover:bg-gray-100"},[g(i(ht),{class:"h-8 w-8 text-gray-900"})]),C(t("div",{ref_key:"optionBlock",ref:fe,class:"items-scretch absolute top-[80%] right-5 z-20 flex min-w-[80px] flex-col justify-start overflow-hidden rounded bg-white shadow"},[d.value.type!="group"?(s(),a("button",{key:0,onClick:Je,type:"button",class:"text-block flex items-center gap-1 p-2 hover:bg-gray-100"},[t("span",null,[g(i(pt),{class:"h-4 w-4"})]),Bl])):h("",!0),h("",!0),t("button",{type:"button",onClick:Pe,class:"flex items-center gap-1 p-2 text-red-500 hover:bg-gray-100"},[t("span",null,[g(i(Q),{class:"h-4 w-4"})]),El])],512),[[L,r.option]])])):h("",!0),t("div",{ref_key:"chatDiv",ref:N,class:"no-scrollbar mx-auto flex w-full grow flex-col-reverse items-center justify-center overflow-scroll p-4 md:max-w-[70%]"},[t("div",Ll,[C(t("div",{ref_key:"optionMessageBlock",ref:q,class:"items-scretch fixed z-50 flex min-w-[100px] flex-col justify-start overflow-hidden rounded bg-white shadow"},[y.value&&y.value.user.id==u.value.id?(s(),a("button",{key:0,type:"button",onClick:Ne,class:"flex items-center gap-1 p-2 text-black hover:bg-gray-100"},[t("span",null,[g(i(ut),{class:"h-4 w-4"})]),Dl])):h("",!0),t("button",{type:"button",onClick:qe,class:"flex items-center gap-1 p-2 text-black hover:bg-gray-100"},[t("span",null,[g(i(gt),{class:"h-4 w-4"})]),Hl]),t("button",{type:"button",onClick:Ye,class:"flex items-center gap-1 p-2 text-red-500 hover:bg-gray-100"},[t("span",null,[g(i(Q),{class:"h-4 w-4"})]),Ul])],512),[[L,r.optionMessage&&!r.editMessage]]),d.value&&i(ke).length!=[]?(s(!0),a(f,{key:0},w(i(ke),(e,b)=>(s(),a("div",{key:b,class:"w-full"},[t("div",{class:v(["sticky top-0 my-4 flex items-center justify-center",[r.editMessage?"blur":""]])},[t("span",Al,p(B(e[0].date,!0)),1)],2),(s(!0),a(f,null,w(e,(n,R)=>(s(),a("div",{key:n.id,class:v(["relative mb-2 flex w-full flex-col",[n.user.id==u.value.id?"items-end":"items-start"]])},[t("div",{onContextmenu:Ue(S=>Ze(S,n),["prevent"]),class:v(["relative block max-w-[90%] whitespace-pre-line break-all p-2 text-xs leading-normal tracking-wider shadow",[n.user.id==u.value.id&&r.editMessage&&y.value&&y.value.id!=n.id?"rounded-l-lg rounded-tr-lg bg-primary-blue text-white blur":n.user.id!=u.value.id&&r.editMessage?"rounded-r-lg rounded-bl-lg bg-white text-black blur":n.user.id==u.value.id?"rounded-l-lg rounded-tr-lg bg-primary-blue text-white":"rounded-r-lg rounded-bl-lg bg-white text-black"]])},[n.type=="image"?(s(),a("a",{key:0,href:n.attachement_path,download:n.attachement_name,class:"group relative mb-2 block min-h-[150px] min-w-[150px] overflow-hidden rounded"},[t("span",Vl,[t("span",Ol,[g(i(Le),{class:"h-5 w-5"})]),Il]),t("img",{src:n.attachement_path,class:"max-h-[300px]",alt:""},null,8,Kl),t("span",Nl,[t("span",ql,p(n.attachement_name),1),t("span",Yl,p(n.attachement_size),1)])],8,Rl)):h("",!0),n.type=="file"?(s(),a("a",{key:1,href:n.attachement_path,download:n.attachement_name,class:"group relative mb-2 flex w-[300px] items-stretch justify-start overflow-hidden rounded bg-white/25"},[t("span",Pl,[t("span",Wl,[g(i(Le),{class:"h-5 w-5"})]),Gl]),t("div",Ql,[t("span",null,p(n.attachement_name.split(".").pop()),1)]),t("div",Xl,[t("span",Zl,p(n.attachement_name),1),t("span",ea,p(n.attachement_size),1)])],8,Jl)):h("",!0),t("span",ta,p(n.message),1),t("span",sa,[t("span",{class:v(["block h-2 w-2 rounded-full",[n.is_send?n.is_read?"bg-green-500":"bg-gray-300  ":"bg-red-500"]])},null,2),t("span",la,p(B(n.date,!1)),1),n.is_edit?(s(),a("span",aa,"Modifi\xE9")):h("",!0)])],42,Tl),y.value&&y.value.id==n.id&&r.editMessage?(s(),a("div",oa,[g(i(He),{onClick:o[6]||(o[6]=()=>{r.emoji=!r.emoji}),class:"absolute bottom-2 left-1 h-6 w-6 cursor-pointer text-gray-700"}),C(t("textarea",{ref_for:!0,ref_key:"textareaEdit",ref:pe,placeholder:"Your message...","onUpdate:modelValue":S=>y.value.message=S,onInput:o[7]||(o[7]=S=>$e(S.target.value)),onKeydown:o[8]||(o[8]=Be(S=>Xe(S),["enter"])),rows:be.value,class:"w-full resize-none rounded-xl border border-gray-300 bg-white px-8 py-2 text-xs text-gray-900 shadow transition-all focus:border-primary-blue focus:ring-primary-blue",cols:"50"},null,40,na),[[I,y.value.message]]),t("button",{type:"button",onClick:o[9]||(o[9]=S=>ye()),class:"absolute right-1 bottom-2 rounded-full bg-primary-blue p-1 text-white"},[i(E)==1?(s(),a("span",ra,[g(ue,{size:"small"})])):(s(),a("span",ia,[g(i(De),{class:"h-4 w-4"})]))])])):h("",!0)],2))),128))]))),128)):h("",!0)])],512),C(t("div",da,[t("div",ua,[t("input",{type:"file",id:"pickimage",class:"hidden",accept:"image/*",onChange:o[10]||(o[10]=e=>et(e)),disabled:r.editMessage},null,40,ca),t("input",{type:"file",id:"pickfile",class:"hidden",onChange:o[11]||(o[11]=e=>tt(e)),disabled:r.editMessage},null,40,ha),t("label",{for:"pickimage",class:v(["mb-1 cursor-pointer rounded-full bg-white p-2 shadow",[r.editMessage?"blur":""]])},[t("span",null,[g(i(re),{class:"h-4 w-4 text-gray-500 md:h-5 md:w-5"})])],2),t("label",{for:"pickfile",class:v(["mb-1 cursor-pointer rounded-full bg-white p-2 shadow",[r.editMessage?"blur":""]])},[t("span",null,[g(i(de),{class:"h-4 w-4 text-gray-500 md:h-5 md:w-5"})])],2),t("div",ga,[c.attachement?(s(),a("div",{key:0,class:v(["mb-0.5 flex w-full items-stretch overflow-hidden rounded bg-white/60",[r.editMessage?"blur":""]])},[t("div",pa,[c.type=="image"?(s(),a("img",{key:0,class:"h-full w-full object-cover",src:c.attachement_path,alt:""},null,8,fa)):(s(),a("div",ma,va))]),t("div",_a,[t("h4",ya,p(c.attachement_name),1),t("p",wa,p(c.attachement_size),1)]),t("button",{type:"button",onClick:o[12]||(o[12]=e=>O(!0)),class:"flex w-10 cursor-pointer items-center justify-center rounded bg-white"},[g(i(ct),{class:"h-5 w-5 text-primary-blue"})])],2)):h("",!0),C(t("div",{ref_key:"emojiBlock",ref:ee,class:"emojiBlock absolute bottom-[110%] z-40 min-h-[100px] min-w-[100px] overflow-hidden rounded-xl bg-white shadow"},ka,512),[[L,r.emoji]]),g(i(He),{onClick:o[13]||(o[13]=()=>{r.editMessage||(r.emoji=!r.emoji)}),class:v(["absolute bottom-3 left-2 h-5 w-5 cursor-pointer text-gray-500",[r.editMessage?"blur":""]])},null,8,["class"]),C(t("textarea",{ref_key:"textarea",ref:ge,rows:me.value,onKeydown:Be(Ge,["enter"]),"onUpdate:modelValue":o[14]||(o[14]=e=>c.message=e),onInput:Qe,disabled:r.editMessage,class:v(["mr-2 block w-full resize-none rounded-lg border border-gray-300 bg-white py-2.5 pr-2.5 pl-8 text-sm text-gray-900 shadow transition-all focus:border-primary-blue focus:ring-primary-blue",[r.editMessage?"blur":""]]),placeholder:"Your message..."},null,42,Ma),[[I,c.message]])]),t("button",{class:v([[r.editMessage?"blur":""],"mb-0.5 flex h-8 w-8 flex-shrink-0 cursor-pointer items-center justify-center rounded-full bg-primary-blue text-white shadow md:h-10 md:w-10"]),type:"button",onClick:o[15]||(o[15]=e=>Ce()),disabled:r.editMessage},[i(E)==1?(s(),a("span",$a,[g(ue,{size:"small"})])):(s(),a("span",ja,[g(i(De),{class:"h-5 w-5 md:h-6 md:w-6"})]))],10,Ca)])],512),[[L,d.value!=null]])],512),[[L,r.chat]])])]),C(t("div",za,[t("div",Fa,[Sa,t("div",Ba,[y.value&&y.value.user.id==u.value.id?(s(),a("button",{key:0,onClick:o[16]||(o[16]=e=>we(!0)),type:"button",class:"rounded-full border border-gray-400 bg-white px-2 py-1 text-sm hover:bg-gray-100"}," Supprimer pour tout le monde ")):h("",!0),t("button",{onClick:o[17]||(o[17]=e=>we(!1)),type:"button",class:"rounded-full border border-gray-400 bg-white px-2 py-1 text-sm hover:bg-gray-100"}," Supprimer pour moi "),t("button",{onClick:o[18]||(o[18]=e=>r.deleteMessage=!1),type:"button",class:"rounded-full border border-gray-400 bg-white px-2 py-1 text-sm hover:bg-gray-100"}," Annuler ")])])],512),[[L,r.deleteMessage]])]))}};export{Ka as default};
