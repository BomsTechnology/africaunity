var Se=Math.pow;var w=(x,j,z)=>new Promise((D,K)=>{var O=y=>{try{$(z.next(y))}catch(v){K(v)}},U=y=>{try{$(z.throw(y))}catch(v){K(v)}},$=y=>y.done?D(y.value):Promise.resolve(y.value).then(O,U);$((z=z.apply(x,j)).next())});import{d as s,e as a,f as t,r as C,I as S,L as H,m as Te,K as q,h as i,g,M as he,t as p,F as f,x as M,N as ot,a as Be,o as nt,O as re,c as Ee,l as V,w as rt,j as it,P as dt,k as h,n as _,Q as Le}from"./app.js";import{_ as ut,r as ct,a as De,b as He,c as Ue}from"./StartConversation.js";import{u as ge}from"./chatServices.js";import{r as ie}from"./UserCircleIcon.js";import{r as de}from"./PhotoIcon.js";import{r as ue}from"./UserGroupIcon.js";import{r as Z}from"./TrashIcon.js";import{r as ht}from"./PencilSquareIcon.js";import{r as Ae}from"./FaceSmileIcon.js";import{r as gt}from"./XMarkIcon.js";import"./userServices.js";function pt(x,j){return s(),a("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[t("path",{"fill-rule":"evenodd",d:"M10.5 6a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zm0 6a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zm0 6a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0z","clip-rule":"evenodd"})])}function ft(x,j){return s(),a("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[t("path",{"fill-rule":"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z","clip-rule":"evenodd"})])}function ee(x,j){return s(),a("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[t("path",{"fill-rule":"evenodd",d:"M19.5 21a3 3 0 003-3V9a3 3 0 00-3-3h-5.379a.75.75 0 01-.53-.22L11.47 3.66A2.25 2.25 0 009.879 3H4.5a3 3 0 00-3 3v12a3 3 0 003 3h15zM9 12.75a.75.75 0 000 1.5h6a.75.75 0 000-1.5H9z","clip-rule":"evenodd"})])}function mt(x,j){return s(),a("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[t("path",{"fill-rule":"evenodd",d:"M19.5 21a3 3 0 003-3V9a3 3 0 00-3-3h-5.379a.75.75 0 01-.53-.22L11.47 3.66A2.25 2.25 0 009.879 3H4.5a3 3 0 00-3 3v12a3 3 0 003 3h15zm-6.75-10.5a.75.75 0 00-1.5 0v2.25H9a.75.75 0 000 1.5h2.25v2.25a.75.75 0 001.5 0v-2.25H15a.75.75 0 000-1.5h-2.25V10.5z","clip-rule":"evenodd"})])}function ce(x,j){return s(),a("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[t("path",{"fill-rule":"evenodd",d:"M18.97 3.659a2.25 2.25 0 00-3.182 0l-10.94 10.94a3.75 3.75 0 105.304 5.303l7.693-7.693a.75.75 0 011.06 1.06l-7.693 7.693a5.25 5.25 0 11-7.424-7.424l10.939-10.94a3.75 3.75 0 115.303 5.304L9.097 18.835l-.008.008-.007.007-.002.002-.003.002A2.25 2.25 0 015.91 15.66l7.81-7.81a.75.75 0 011.061 1.06l-7.81 7.81a.75.75 0 001.054 1.068L18.97 6.84a2.25 2.25 0 000-3.182z","clip-rule":"evenodd"})])}function te(x,j){return s(),a("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[t("path",{"fill-rule":"evenodd",d:"M12 3.75a.75.75 0 01.75.75v6.75h6.75a.75.75 0 010 1.5h-6.75v6.75a.75.75 0 01-1.5 0v-6.75H4.5a.75.75 0 010-1.5h6.75V4.5a.75.75 0 01.75-.75z","clip-rule":"evenodd"})])}const vt={class:"fixed inset-0 z-40 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},bt={class:"flex min-h-screen items-end justify-center px-4 pt-4 pb-20 text-center sm:block sm:p-0"},_t=t("span",{class:"hidden sm:inline-block sm:h-screen sm:align-middle","aria-hidden":"true"},"\u200B",-1),yt={class:"inline-block transform overflow-hidden rounded-lg p-4 bg-white text-left align-middle shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg"},wt=t("h1",{class:"text-2xl font-bold text-black"}," Ajouter un dossier ",-1),xt=["onSubmit"],kt={class:"relative"},Mt={class:"mt-5"},Ct=["disabled"],$t={key:0},jt={key:1},zt={__name:"CreateConversationFolder",props:{open:Boolean,toogleModal:Function},emits:["folderCreated"],setup(x,{emit:j}){const{createConversationFolder:z,loading:D,getConversationsFolderUser:K,errors:O}=ge(),U=JSON.parse(localStorage.user),$=C(""),y=()=>w(this,null,function*(){yield z({name:$.value,user_id:U.id}),j("folderCreated")});return(v,A)=>S((s(),a("div",vt,[t("div",bt,[t("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",style:{"backdrop-filter":"blur(5px)"},"aria-hidden":"true",onClick:A[0]||(A[0]=(...B)=>x.toogleModal&&x.toogleModal(...B))}),_t,t("div",yt,[wt,t("form",{onSubmit:Te(y,["prevent"]),class:"relative mt-5"},[t("div",kt,[S(t("input",{type:"text","onUpdate:modelValue":A[1]||(A[1]=B=>$.value=B),class:"block w-full rounded-sm border border-gray-300 bg-gray-50 p-2.5 text-md text-gray-900 focus:border-blue-500 focus:ring-blue-500",placeholder:"Nom du dossier",required:""},null,512),[[q,$.value]])]),t("div",Mt,[t("button",{type:"submit",disabled:i(D),class:"text-md w-full rounded bg-primary-blue px-6 py-3 leading-5 text-white focus:outline-none"},[i(D)==1?(s(),a("span",$t,[g(he,{size:"small"})])):(s(),a("span",jt,p(v.$t("save")),1))],8,Ct)])],40,xt)])])],512)),[[H,x.open]])}},Ft={class:"fixed inset-0 z-40 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},St={class:"flex min-h-screen items-end justify-center px-4 pt-4 pb-20 text-center sm:block sm:p-0"},Bt=t("span",{class:"hidden sm:inline-block sm:h-screen sm:align-middle","aria-hidden":"true"},"\u200B",-1),Et={class:"inline-block transform overflow-hidden rounded-lg bg-white text-left align-middle shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg"},Lt={class:"relative rounded-lg bg-white py-4"},Dt=t("h1",{class:"text-2xl font-bold text-black mx-4"}," Selectionner un dossier ",-1),Ht={class:"max-h-96 min-h-[200px] overflow-y-auto mt-5"},Ut=["onClick"],At={key:1},Tt={__name:"AddConversationToFolder",props:{open:Boolean,toogleModal:Function,folders:Array,conversation:Object},emits:["conversationAdded"],setup(x,{emit:j}){const z=x,{loading:D,errors:K,addConversationToFolder:O}=ge(),U=$=>w(this,null,function*(){const y=$.conversations.filter(v=>v.id==z.conversation.id)[0];y||(yield O({conversation_id:z.conversation.id,conversation_folder_id:$.id})),j("conversationAdded",{isExist:!!y,folder:$})});return($,y)=>S((s(),a("div",Ft,[t("div",St,[t("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true",style:{"backdrop-filter":"blur(5px)"},onClick:y[0]||(y[0]=(...v)=>x.toogleModal&&x.toogleModal(...v))}),Bt,t("div",Et,[t("div",Lt,[Dt,t("div",Ht,[x.folders.length!=[]?(s(!0),a(f,{key:0},M(x.folders,v=>(s(),a("button",{type:"button",key:v.id,onClick:A=>U(v),class:"cursor-pointer block w-full text-xl text-left bg-white px-6 py-2 hover:bg-gray-100"},p(v.name),9,Ut))),128)):(s(),a("div",At,[g(ot)]))])])])])],512)),[[H,x.open]])}};const Rt={class:"mx-auto w-full bg-white p-4 lg:px-20 xl:w-[90%]"},Vt={class:"relative h-full w-full overflow-x-auto sm:rounded-lg"},Ot={class:"relative flex h-[500px] w-full rounded-lg bg-white shadow-lg md:h-[700px]"},It={key:0,class:"w-full py-4"},Kt={class:"relative mx-2"},Nt={class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},qt={class:"mt-2 w-full px-2 py-2"},Yt={class:"no-scrollbar overflow-x-auto overflow-y-hidden"},Jt={class:"content items-scretch flex justify-start border-b"},Pt=t("span",null,"Tous",-1),Wt=[Pt],Gt=["onClick"],Qt={class:"flex flex-shrink-0 items-center justify-center"},Xt={class:"grow overflow-y-auto"},Zt=["onClick"],es={key:0,class:"group relative flex h-24 w-full cursor-pointer items-center space-x-2 border-b p-3"},ts={class:"h-12 w-12 overflow-hidden rounded lg:h-16 lg:w-16"},ss=["src"],ls={class:"flex-grow"},as={class:"flex w-full justify-between"},os={class:"whitespace-normal break-words text-base font-bold"},ns={key:0},rs={key:0,class:"text-xs"},is={class:"flex w-full items-center justify-between"},ds={class:"flex items-center gap-1 whitespace-normal text-sm font-light"},us={class:"flex w-full items-center justify-start gap-0.5 overflow-hidden overflow-ellipsis"},cs={key:0},hs={key:1},gs={key:0},ps={key:0,class:"flex h-6 w-6 items-center justify-center rounded-full bg-primary-blue text-sm font-light text-white"},fs=["onClick"],ms={key:1,class:"group flex h-24 w-full cursor-pointer items-center space-x-2 border-b p-3 hover:bg-gray-50"},vs={class:"h-12 w-12 overflow-hidden rounded lg:h-16 lg:w-16"},bs=["src"],_s={class:"flex-grow"},ys={class:"flex w-full justify-between"},ws={class:"whitespace-normal break-words text-base font-bold"},xs={key:0},ks={key:1},Ms={key:0,class:"text-xs"},Cs={class:"flex w-full items-center justify-between"},$s={class:"whitespace-normal text-sm font-light text-gray-800"},js={class:"w-full overflow-hidden overflow-ellipsis"},zs={key:0},Fs={key:0,class:"flex h-6 w-6 items-center justify-center rounded-full bg-primary-blue text-sm font-light text-white"},Ss=["onClick"],Bs=t("p",{class:"text-sm"},"Supprimer ce dossier",-1),Es={class:"relative hidden w-full max-w-[30%] flex-col border-x py-4 lg:flex"},Ls={class:"relative mx-2"},Ds={class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},Hs={class:"mt-2 w-full px-2 py-2"},Us={class:"content items-scretch flex justify-start border-b"},As=t("span",null,"Tous",-1),Ts=[As],Rs=["onClick"],Vs={class:"flex flex-shrink-0 items-center justify-center"},Os={class:"grow overflow-y-auto"},Is=["onClick"],Ks={key:0,class:"group relative flex h-24 w-full cursor-pointer items-center space-x-2 border-b p-3"},Ns={class:"h-12 w-12 overflow-hidden rounded lg:h-16 lg:w-16"},qs=["src"],Ys={class:"flex-grow"},Js={class:"flex w-full justify-between"},Ps={class:"whitespace-normal break-words text-base font-bold"},Ws={key:0},Gs={key:0,class:"text-xs"},Qs={class:"flex w-full items-center justify-between"},Xs={class:"flex items-center gap-1 whitespace-normal text-sm font-light"},Zs={class:"flex w-full items-center justify-start gap-0.5 overflow-hidden overflow-ellipsis"},el={key:0},tl={key:1},sl={key:0},ll={key:0,class:"flex h-6 w-6 items-center justify-center rounded-full bg-primary-blue text-sm font-light text-white"},al=["onClick"],ol={key:1,class:"group flex h-24 w-full cursor-pointer items-center space-x-2 border-b p-3 hover:bg-gray-50"},nl={class:"h-12 w-12 overflow-hidden rounded lg:h-16 lg:w-16"},rl=["src"],il={class:"flex-grow"},dl={class:"flex w-full justify-between"},ul={class:"whitespace-normal break-words text-base font-bold"},cl={key:0},hl={key:1},gl={key:0,class:"text-xs"},pl={class:"flex w-full items-center justify-between"},fl={class:"whitespace-normal text-sm font-light text-gray-800"},ml={class:"w-full overflow-hidden overflow-ellipsis"},vl={key:0},bl={key:0,class:"flex h-6 w-6 items-center justify-center rounded-full bg-primary-blue text-sm font-light text-white"},_l=["onClick"],yl=t("p",{class:"text-sm"},"Supprimer ce dossier",-1),wl={class:"bg-chat relative flex w-full grow flex-col border-r"},xl={key:0,class:"relative flex h-24 w-full items-center justify-between space-x-2 border-b bg-white p-3"},kl={class:"flex items-center gap-2"},Ml={class:"h-12 w-12 overflow-hidden rounded-full drop-shadow-md"},Cl=["src"],$l=["src"],jl={class:"whitespace-normal text-sm font-bold"},zl={key:0},Fl={key:0},Sl={key:1},Bl={class:"text-[11px]"},El={key:0},Ll=t("p",{class:"text-sm"},"Ajouter \xE0 un dossier",-1),Dl=t("p",{class:"text-sm"},"Supprimer",-1),Hl={class:"flex min-h-0 w-full flex-col items-end justify-end"},Ul=t("p",{class:"text-xs"},"Editer",-1),Al=t("p",{class:"text-xs"},"Signaler",-1),Tl=t("p",{class:"text-xs"},"Supprimer",-1),Rl={class:"rounded bg-white px-2 py-1 text-center text-xs uppercase text-gray-700 shadow"},Vl=["onContextmenu"],Ol=["href","download"],Il={style:{"backdrop-filter":"blur(5px)"},class:"absolute right-0 top-0 hidden items-center bg-white/50 p-2 text-primary-blue hover:bg-primary-blue/50 hover:text-black group-hover:flex"},Kl={class:"block"},Nl=t("span",{class:"block"},"Telecharger",-1),ql=["src"],Yl={class:"absolute bottom-0 w-full bg-white/50 p-2 text-xs"},Jl={class:"block break-words text-xs font-medium"},Pl={class:"mt-1 block break-words text-[11px]"},Wl=["href","download"],Gl={style:{"backdrop-filter":"blur(5px)"},class:"absolute right-0 top-0 hidden items-center bg-white/50 p-2 text-primary-blue hover:bg-primary-blue/50 hover:text-black group-hover:flex"},Ql={class:"block"},Xl=t("span",{class:"block"},"Telecharger",-1),Zl={class:"flex h-20 w-32 items-center justify-center bg-gray-500 font-bold uppercase text-white"},ea={class:"flex grow flex-col items-start justify-start p-2"},ta={class:"break-words text-xs"},sa={class:"break-words text-[11px]"},la={class:"text-md"},aa={class:"mt-2 flex items-center gap-1 text-right text-xs font-light"},oa={class:"block"},na={key:0,class:"block italic"},ra={key:0,class:"relative mt-2"},ia=["onUpdate:modelValue","rows"],da={key:0},ua={key:1},ca={class:"mx-auto w-full md:max-w-[70%]"},ha={class:"relative flex items-end gap-2 rounded-lg py-2 px-3"},ga=["disabled"],pa=["disabled"],fa={class:"relative flex w-full flex-col"},ma={class:"h-20 w-32"},va=["src"],ba={key:1,class:"flex h-full w-full items-center justify-center bg-gray-500 text-white"},_a=t("span",null,"File",-1),ya=[_a],wa={class:"flex grow flex-col items-start justify-start p-2"},xa={class:"break-words text-xs"},ka={class:"break-words text-[11px]"},Ma=t("emoji-picker",{locale:"fr"},null,-1),Ca=[Ma],$a=["rows","onKeydown","disabled"],ja=["disabled"],za={key:0},Fa={key:1},Sa={class:"fixed top-0 left-0 z-20 flex h-screen w-screen items-center justify-center",style:{"backdrop-filter":"blur(5px)"}},Ba={class:"min-w-[300px] rounded bg-white p-4 shadow"},Ea=t("p",{class:""},"Supprimer le message ?",-1),La={class:"mt-5 flex flex-col items-end justify-end gap-3"},Ya={__name:"Chat",setup(x){const{createConversation:j,loading:z,errors:D,conversation:K,createMessage:O,destroyConversation:U,updateMessage:$,getConversationsUser:y,conversations:v,isRead:A,folders:B,getConversationsFolderUser:T,removeCoversationToFolder:Re,destroyCoversationFolder:Ve,deleteMessage:Oe,reportMessage:Ie}=ge(),Y=C(null),pe=C(null),fe=C(null),m=C(null),F=C(null),se=C(null),me=C(null),J=C(null),ve=C(1),be=C(1),R=C(""),le=C(!1),P=C(!1),W=C(!1),d=C(null),k=C(null),u=C(null);u.value=JSON.parse(localStorage.user);const r=Be({chat:!0,conversation:!1,emoji:!1,option:!1,optionMessage:!1,editMessage:!1,deleteMessage:!1}),c=Be({message:"",user_id:u.value.id,conversation_id:"",attachement:null,attachement_path:"",attachement_name:"",attachement_size:"",type:"text"});nt(()=>w(this,null,function*(){yield y(u.value.id),F.value=v.value,yield T(u.value.id),document.onkeydown=function(l){l=l||window.event,l.keyCode==27&&(r.emoji?r.emoji=!1:r.editMessage?(r.editMessage=!1,r.optionMessage=!1):r.optionMessage?r.optionMessage=!1:r.option?r.option=!1:d.value?(d.value=null,N()):m.value=null)},se.value.querySelector("emoji-picker").addEventListener("emoji-click",l=>{r.editMessage?k.value.message+=`${l.detail.unicode} `:c.message+=`${l.detail.unicode} `}),window.Echo.channel(`chat.${u.value.id}`).listen(".chat-update",l=>w(this,null,function*(){ne(),at()}))})),re(se,()=>{r.emoji=!1}),re(me,()=>{r.option=!1}),re(J,()=>{r.optionMessage=!1});const N=(l=!1)=>{l||(c.message="",c.conversation_id=""),c.attachement="",c.attachement_path="",c.attachement_name="",c.attachement_size="",c.type="text",r.editMessage=!1,k.value=null};function _e(l){switch(l){case"chat":r.conversation=!1,r.chat=!0;break;case"conversation":r.chat=!1,r.conversation=!0;break}}const G=()=>{le.value=!le.value},ae=()=>{W.value=!W.value},ye=()=>{P.value=!P.value},Ke=()=>w(this,null,function*(){yield T(u.value.id),W.value=!1}),Ne=l=>w(this,null,function*(){r.option=!1,F.value=l.folder.conversations,m.value=l.folder,P.value=!1,l.isExist||(yield T(u.value.id).then(o=>{let e=B.value.filter(b=>b.id==l.folder.id)[0];F.value=e.conversations,m.value=e}))}),qe=l=>w(this,null,function*(){G();let o=v.value.filter(e=>e.users.find(b=>b.id==l.id))[0];o?d.value=o:(yield j({users:[u.value.id,l.id]}),yield y(u.value.id),ne()),N()}),Ye=()=>{r.editMessage=!0,setTimeout(()=>{je(fe.value[0].value)},100)},we=()=>w(this,null,function*(){const l=d.value.users.filter(o=>o.id!=u.value.id)[0];k.value.is_edit=!0,r.editMessage=!1,$(k.value.id,{text:k.value.message,received_id:l.id})}),xe=l=>w(this,null,function*(){r.deleteMessage=!1;const o=d.value.messages.indexOf(k.value);if(o>=0){const e=d.value.users.filter(b=>b.id!=u.value.id)[0];d.value.messages.splice(o,1),yield Oe(k.value.id,{for:l,user_id:u.value.id,received_id:e.id})}}),Je=()=>w(this,null,function*(){r.optionMessage=!1,yield Ie({conversation_id:d.value.id,message_id:k.value.id}),alert("Report sucess")}),Pe=()=>w(this,null,function*(){r.optionMessage=!1,r.deleteMessage=!0}),We=()=>w(this,null,function*(){ye(),r.option=!1}),Q=l=>w(this,null,function*(){if(confirm("Are you sure you want to remove this conversation in folder?")){const o=m.value.conversations.indexOf(l);o>=0&&(m.value.conversations.splice(o,1),yield Re(m.value.id,l.id),yield T(u.value.id))}}),ke=()=>w(this,null,function*(){confirm("Are you sure you want to delete this folder?")&&(yield Ve(m.value.id),F.value=v.value,m.value=null,yield T(u.value.id))}),Ge=()=>w(this,null,function*(){confirm("Are you sure you want to delete this conversation?")&&(r.option=!1,yield U(d.value.id,{user_id:u.value.id}),d.value=null,yield y(u.value.id),yield T(u.value.id),m.value==null?F.value=v.value:(m.value=B.value.filter(l=>l.id===m.value.id)[0],F.value=m.value.conversations))}),X=Ee(()=>F.value?F.value.filter(l=>l.users.some(o=>o.id!=u.value.id&&(o.firstname.toLowerCase().includes(R.value.toLowerCase())||o.lastname.toLowerCase().includes(R.value.toLowerCase())||o.email.toLowerCase().includes(R.value.toLowerCase())))):[]),Me=Ee(()=>{let l={};return d.value.messages.forEach(o=>{l[`${L(o.date,!0)}`]||(l[`${L(o.date,!0)}`]=[]),l[`${L(o.date,!0)}`].push(o)}),l}),oe=l=>{F.value=l.conversations,m.value=l};function Ce(l){d.value=l,c.conversation_id=l.id,N();const o=d.value.users.filter(e=>e.id!=u.value.id)[0];A({conversation_id:d.value.id,user_id:u.value.id,received_id:o.id}),_e("chat")}function $e(){return w(this,null,function*(){if(d.value&&!z.value&&(c.message||c.attachement)){c.conversation_id=d.value.id;const l={id:new Date().getTime(),user_id:u.value.id,user:u.value,is_send:!1,is_read:!1,date:Date.now(),attachement_path:c.attachement_path,attachement_name:c.attachement_name,message:c.message,type:c.type,conversation_id:c.conversation_id};v.value.filter(b=>b.id===d.value.id)[0].messages.push(l),oe.value&&d.value.messages.push(l);const o=d.value.users.filter(b=>b.id!=u.value.id)[0];let e=new FormData;e.append("received_id",o.id),e.append("user_id",u.value.id),e.append("conversation_id",c.conversation_id),e.append("attachement",c.attachement),e.append("attachement_path",c.attachement_path),e.append("attachement_name",c.attachement_name),e.append("attachement_size",c.attachement_size),e.append("type",c.type),e.append("message",c.message),N(),yield O(e),ne()}})}function L(l,o,e=!1){l=new Date(l);const b=new Date,n=Math.round((b-l)/(1e3*60*60*24)),I={weekday:"long",year:"numeric",month:"long",day:"numeric"},E=["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"];return n===0?o?"Aujourd'hui":`${l.getHours()>9?l.getHours():"0"+l.getHours()}:${l.getMinutes()>9?l.getMinutes():"0"+l.getMinutes()}`:n===1?o||e?"Hier":`${l.getHours()>9?l.getHours():"0"+l.getHours()}:${l.getMinutes()>9?l.getMinutes():"0"+l.getMinutes()}`:n>1&&n<7?o||e?E[l.getDay()]:`${l.getHours()>9?l.getHours():"0"+l.getHours()}:${l.getMinutes()>9?l.getMinutes():"0"+l.getMinutes()}`:o&&!e?l.toLocaleDateString("fr-FR",I):!o&&e?l.toLocaleDateString("fr-FR"):`${l.getHours()>9?l.getHours():"0"+l.getHours()}:${l.getMinutes()>9?l.getMinutes():"0"+l.getMinutes()}`}const Qe=l=>{l.preventDefault();const o=l.currentTarget,e=l.deltaY;o.scrollLeft+=e},Xe=l=>{if(l.shiftKey&&l.key==="Enter"){l.preventDefault();const o=l.target,e=o.selectionStart,b=o.selectionEnd,n=o.value;o.value=n.substring(0,e)+`
`+n.substring(b),o.selectionStart=o.selectionEnd=e+1}else l.preventDefault(),$e()},Ze=()=>{const o=(pe.value.value.match(/\n/g)||[]).length+1;ve.value=o<10?o:10},et=l=>{if(l.shiftKey&&l.key==="Enter"){l.preventDefault();const o=l.target,e=o.selectionStart,b=o.selectionEnd,n=o.value;o.value=n.substring(0,e)+`
`+n.substring(b),o.selectionStart=o.selectionEnd=e+1}else l.preventDefault(),we()},je=l=>{const o=(l.match(/\n/g)||[]).length+1;be.value=o<10?o:10},tt=(l,o)=>{l.preventDefault(),r.editMessage||(J.value.style.left=`${l.clientX+10}px`,J.value.style.top=`${l.clientY+10}px`,r.option=!1,r.emoji=!1,k.value=o,r.optionMessage=!0)},st=l=>w(this,null,function*(){const o=l.target.files[0];c.type="image",c.attachement=o,c.attachement_name=o.name,c.attachement_path=ze(o),c.attachement_size=Fe(o.size)}),lt=l=>w(this,null,function*(){const o=l.target.files[0];c.type="file",c.attachement=o,c.attachement_name=o.name,c.attachement_path=ze(o),c.attachement_size=Fe(o.size)}),at=()=>{Y.value!=null&&Y.value.scroll({top:Y.value.scrollHeight,behavior:"smooth"})},ne=()=>w(this,null,function*(){yield y(u.value.id),d.value&&(d.value=v.value.filter(l=>l.id===d.value.id)[0]),yield T(u.value.id),m.value==null?F.value=v.value:(m.value=B.value.filter(l=>l.id===m.value.id)[0],F.value=m.value.conversations)});function ze(l){return URL.createObjectURL(l)}function Fe(l){const o=["Bytes","KB","MB","GB","TB"];if(l===0)return"n/a";const e=parseInt(Math.floor(Math.log(l)/Math.log(1024)),10);return e===0?`${l} ${o[e]})`:`${(l/Se(1024,e)).toFixed(1)} ${o[e]}`}return(l,o)=>(s(),a("div",Rt,[g(ut,{open:le.value,toogleModal:G,conversationSelect:qe},null,8,["open"]),g(Tt,{open:P.value,toogleModal:ye,folders:i(B),conversation:d.value,onConversationAdded:Ne},null,8,["open","folders","conversation"]),g(zt,{open:W.value,toogleModal:ae,onFolderCreated:Ke},null,8,["open"]),i(D)!=""?(s(),V(dt,{key:0},{default:rt(()=>[it(p(i(D)),1)]),_:1})):h("",!0),t("section",Vt,[t("div",Ot,[t("button",{onClick:o[0]||(o[0]=e=>_e("conversation")),type:"button",class:_([[r.conversation?" border-primary-blue bg-primary-blue ":"   border-primary-blue bg-white  text-primary-blue "],"absolute left-0 top-0 z-10 rounded-full border p-2 text-white shadow lg:hidden"])},[g(i(ct),{class:"h-5 w-5"})],2),r.conversation?(s(),a("div",It,[t("div",Kt,[t("div",Nt,[g(i(De),{class:"h-5 w-5 text-gray-500"})]),S(t("input",{type:"text","onUpdate:modelValue":o[1]||(o[1]=e=>R.value=e),class:"block w-full border border-gray-300 bg-gray-50 p-2.5 pl-10 text-sm text-gray-900 focus:border-primary-blue focus:ring-primary-blue",placeholder:"Rechercher...",required:""},null,512),[[q,R.value]])]),t("button",{type:"button",onClick:G,class:"absolute bottom-10 right-5 flex h-12 w-12 cursor-pointer items-center justify-center rounded-full bg-primary-blue p-2 text-white shadow-lg"},[g(i(te),{class:"h-10 w-10"})]),t("div",qt,[t("div",Yt,[t("div",Jt,[t("button",{type:"button",onClick:o[2]||(o[2]=()=>{F.value=i(v),m.value=null}),class:_(["flex-shrink-0 cursor-pointer rounded-t-md py-2 px-4 text-center font-bold",[m.value?"border-gray-500 text-gray-500 hover:bg-gray-50":"border-b-2 border-primary-blue text-primary-blue hover:bg-blue-100"]])},Wt,2),(s(!0),a(f,null,M(i(B),e=>(s(),a("button",{type:"button",key:e.id,onClick:b=>oe(e),class:_(["flex-shrink-0 cursor-pointer rounded-t-md py-2 px-4 text-center font-bold",[m.value&&m.value.id==e.id?"border-b-2 border-primary-blue text-primary-blue hover:bg-blue-100":"border-gray-500 text-gray-500 hover:bg-gray-50"]])},[t("span",null,p(e.name),1)],10,Gt))),128)),t("div",Qt,[t("button",{type:"button",onClick:ae,class:"flex h-5 w-5 cursor-pointer items-center justify-center rounded-full bg-primary-blue p-0.5 text-white shadow-lg"},[g(i(te),{class:"h-full w-full"})])])])])]),t("div",Xt,[X.value.length!=[]?(s(!0),a(f,{key:0},M(X.value,(e,b)=>(s(),a("div",{key:e.id,onClick:n=>Ce(e),class:_([d.value&&d.value.id==e.id?"bg-primary-blue text-white":"text-gray-800 hover:bg-gray-100"])},[e.type=="conversation"?(s(),a("div",es,[t("div",ts,[(s(!0),a(f,null,M(e.users,n=>(s(),a(f,null,[n.avatar&&n.id!=u.value.id?(s(),a("img",{key:0,src:n.avatar,class:"h-full w-full bg-cover object-cover",alt:""},null,8,ss)):(s(),V(i(ie),{key:1,class:"h-full w-full"}))],64))),256))]),t("div",ls,[t("div",as,[t("h1",os,[(s(!0),a(f,null,M(e.users,n=>(s(),a(f,null,[n.id!=u.value.id?(s(),a("span",ns,p(n.firstname),1)):h("",!0)],64))),256))]),e.messages.length>0?(s(),a("span",rs,p(L(e.messages[e.messages.length-1].date,!1,!0)),1)):h("",!0)]),t("div",is,[t("h6",ds,[e.messages.length>0?(s(),a(f,{key:0},[t("span",{class:_(["block h-2 w-2 flex-shrink-0 rounded-full",[e.messages[e.messages.length-1].is_send?e.messages[e.messages.length-1].is_read?"bg-green-500":"bg-gray-400  ":"bg-red-500"]])},null,2),t("span",us,[e.messages[e.messages.length-1].type=="file"?(s(),a("span",cs,[g(i(ce),{class:"h-4 w-4"})])):e.messages[e.messages.length-1].type=="image"?(s(),a("span",hs,[g(i(de),{class:"h-4 w-4"})])):h("",!0),t("span",null,p(e.messages[e.messages.length-1].message.length>35?e.messages[e.messages.length-1].message.substring(0,35)+"...":e.messages[e.messages.length-1].message),1)])],64)):(s(!0),a(f,{key:1},M(e.users,n=>(s(),a(f,null,[n.id!=u.value.id?(s(),a("span",gs,p(n.email),1)):h("",!0)],64))),256))]),e.nbUnRead>0?(s(),a("span",ps,[t("span",null,p(e.nbUnRead),1)])):h("",!0)])]),m.value?(s(),a("button",{key:0,onClick:n=>Q(e),type:"button",class:"hidden h-6 w-6 items-center justify-center rounded-full text-red-300 hover:bg-red-100 hover:text-red-500 group-hover:flex"},[t("span",null,[g(i(ee),{class:"h-4 w-4"})])],8,fs)):h("",!0)])):(s(),a("div",ms,[t("div",vs,[e.image?(s(),a("img",{key:0,src:e.image,class:"h-full w-full bg-cover object-cover",alt:""},null,8,bs)):(s(),V(i(ue),{key:1,class:"h-full w-full text-gray-500"}))]),t("div",_s,[t("div",ys,[t("h1",ws,[e.name?(s(),a("span",xs,p(e.name),1)):(s(),a("span",ks,"Sans nom"))]),e.messages.length>0?(s(),a("span",Ms,p(L(e.messages[e.messages.length-1].date,!0,!0)),1)):h("",!0)]),t("div",Cs,[t("h6",$s,[e.messages.length>0?(s(),a(f,{key:0},[t("span",{class:_(["block h-2 w-2 flex-shrink-0 rounded-full",[e.messages[e.messages.length-1].is_send?e.messages[e.messages.length-1].is_read?"bg-green-500":"bg-gray-400  ":"bg-red-500"]])},null,2),t("span",js,p(e.messages[e.messages.length-1].message.length>35?e.messages[e.messages.length-1].message.substring(0,35)+"...":e.messages[e.messages.length-1].message),1)],64)):(s(!0),a(f,{key:1},M(e.users,(n,I)=>(s(),a("span",null,[I<3?(s(),a("span",zs,p(n.email)+", ",1)):h("",!0)]))),256))]),e.nbUnRead>0?(s(),a("span",Fs,[t("span",null,p(e.nbUnRead),1)])):h("",!0)])]),m.value?(s(),a("button",{key:0,onClick:n=>Q(e),type:"button",class:"flex h-6 w-6 items-center justify-center rounded-full bg-red-100 text-red-500"},[t("span",null,[g(i(ee),{class:"h-4 w-4"})])],8,Ss)):h("",!0)]))],10,Zt))),128)):h("",!0),m.value?(s(),a("button",{key:1,type:"button",onClick:ke,class:"flex w-full items-center justify-center gap-1 p-2 text-red-500 opacity-25 hover:bg-red-100 hover:opacity-100"},[t("span",null,[g(i(Z),{class:"h-4 w-4"})]),Bs])):h("",!0)])])):h("",!0),t("div",Es,[t("div",Ls,[t("div",Ds,[g(i(De),{class:"h-5 w-5 text-gray-500"})]),S(t("input",{type:"text","onUpdate:modelValue":o[3]||(o[3]=e=>R.value=e),class:"block w-full border border-gray-300 bg-gray-50 p-2.5 pl-10 text-sm text-gray-900 focus:border-primary-blue focus:ring-primary-blue",placeholder:"Rechercher...",required:""},null,512),[[q,R.value]])]),t("button",{type:"button",onClick:G,class:"absolute bottom-10 right-5 flex h-12 w-12 cursor-pointer items-center justify-center rounded-full bg-primary-blue p-2 text-white shadow-lg"},[g(i(te),{class:"h-10 w-10"})]),t("div",Hs,[t("div",{onWheel:Qe,class:"no-scrollbar overflow-x-auto overflow-y-hidden"},[t("div",Us,[t("button",{type:"button",onClick:o[4]||(o[4]=()=>{F.value=i(v),m.value=null}),class:_(["flex-shrink-0 cursor-pointer rounded-t-md py-2 px-4 text-center font-bold",[m.value?"border-gray-500 text-gray-500 hover:bg-gray-50":"border-b-2 border-primary-blue text-primary-blue hover:bg-blue-100"]])},Ts,2),(s(!0),a(f,null,M(i(B),e=>(s(),a("button",{type:"button",key:e.id,onClick:b=>oe(e),class:_(["flex-shrink-0 cursor-pointer rounded-t-md py-2 px-4 text-center font-bold",[m.value&&m.value.id==e.id?"border-b-2 border-primary-blue text-primary-blue hover:bg-blue-100":"border-gray-500 text-gray-500 hover:bg-gray-50"]])},[t("span",null,p(e.name),1)],10,Rs))),128)),t("div",Vs,[t("button",{type:"button",onClick:ae,class:"flex h-5 w-5 cursor-pointer items-center justify-center rounded-full bg-primary-blue p-0.5 text-white shadow-lg"},[g(i(te),{class:"h-full w-full"})])])])],32)]),t("div",Os,[X.value.length!=[]?(s(!0),a(f,{key:0},M(X.value,(e,b)=>(s(),a("div",{key:e.id,onClick:n=>Ce(e),class:_([d.value&&d.value.id==e.id?"bg-primary-blue text-white":"text-gray-800 hover:bg-gray-100"])},[e.type=="conversation"?(s(),a("div",Ks,[t("div",Ns,[(s(!0),a(f,null,M(e.users,n=>(s(),a(f,null,[n.avatar&&n.id!=u.value.id?(s(),a("img",{key:0,src:n.avatar,class:"h-full w-full bg-cover object-cover",alt:""},null,8,qs)):(s(),V(i(ie),{key:1,class:"h-full w-full"}))],64))),256))]),t("div",Ys,[t("div",Js,[t("h1",Ps,[(s(!0),a(f,null,M(e.users,n=>(s(),a(f,null,[n.id!=u.value.id?(s(),a("span",Ws,p(n.firstname),1)):h("",!0)],64))),256))]),e.messages.length>0?(s(),a("span",Gs,p(L(e.messages[e.messages.length-1].date,!1,!0)),1)):h("",!0)]),t("div",Qs,[t("h6",Xs,[e.messages.length>0?(s(),a(f,{key:0},[t("span",{class:_(["block h-2 w-2 flex-shrink-0 rounded-full",[e.messages[e.messages.length-1].is_send?e.messages[e.messages.length-1].is_read?"bg-green-500":"bg-gray-400  ":"bg-red-500"]])},null,2),t("span",Zs,[e.messages[e.messages.length-1].type=="file"?(s(),a("span",el,[g(i(ce),{class:"h-4 w-4"})])):e.messages[e.messages.length-1].type=="image"?(s(),a("span",tl,[g(i(de),{class:"h-4 w-4"})])):h("",!0),t("span",null,p(e.messages[e.messages.length-1].message.length>35?e.messages[e.messages.length-1].message.substring(0,35)+"...":e.messages[e.messages.length-1].message),1)])],64)):(s(!0),a(f,{key:1},M(e.users,n=>(s(),a(f,null,[n.id!=u.value.id?(s(),a("span",sl,p(n.email),1)):h("",!0)],64))),256))]),e.nbUnRead>0?(s(),a("span",ll,[t("span",null,p(e.nbUnRead),1)])):h("",!0)])]),m.value?(s(),a("button",{key:0,onClick:n=>Q(e),type:"button",class:"hidden h-6 w-6 items-center justify-center rounded-full text-red-300 hover:bg-red-100 hover:text-red-500 group-hover:flex"},[t("span",null,[g(i(ee),{class:"h-4 w-4"})])],8,al)):h("",!0)])):(s(),a("div",ol,[t("div",nl,[e.image?(s(),a("img",{key:0,src:e.image,class:"h-full w-full bg-cover object-cover",alt:""},null,8,rl)):(s(),V(i(ue),{key:1,class:"h-full w-full text-gray-500"}))]),t("div",il,[t("div",dl,[t("h1",ul,[e.name?(s(),a("span",cl,p(e.name),1)):(s(),a("span",hl,"Sans nom"))]),e.messages.length>0?(s(),a("span",gl,p(L(e.messages[e.messages.length-1].date,!0,!0)),1)):h("",!0)]),t("div",pl,[t("h6",fl,[e.messages.length>0?(s(),a(f,{key:0},[t("span",{class:_(["block h-2 w-2 flex-shrink-0 rounded-full",[e.messages[e.messages.length-1].is_send?e.messages[e.messages.length-1].is_read?"bg-green-500":"bg-gray-400  ":"bg-red-500"]])},null,2),t("span",ml,p(e.messages[e.messages.length-1].message.length>35?e.messages[e.messages.length-1].message.substring(0,35)+"...":e.messages[e.messages.length-1].message),1)],64)):(s(!0),a(f,{key:1},M(e.users,(n,I)=>(s(),a("span",null,[I<3?(s(),a("span",vl,p(n.email)+", ",1)):h("",!0)]))),256))]),e.nbUnRead>0?(s(),a("span",bl,[t("span",null,p(e.nbUnRead),1)])):h("",!0)])]),m.value?(s(),a("button",{key:0,onClick:n=>Q(e),type:"button",class:"hidden h-6 w-6 items-center justify-center rounded-full text-red-300 hover:bg-red-100 hover:text-red-500 group-hover:flex"},[t("span",null,[g(i(ee),{class:"h-4 w-4"})])],8,_l)):h("",!0)]))],10,Is))),128)):h("",!0),m.value?(s(),a("button",{key:1,type:"button",onClick:ke,class:"flex w-full items-center justify-center gap-1 p-2 text-red-500 opacity-25 hover:bg-red-100 hover:opacity-100"},[t("span",null,[g(i(Z),{class:"h-4 w-4"})]),yl])):h("",!0)])]),S(t("div",wl,[d.value?(s(),a("div",xl,[t("div",kl,[t("div",Ml,[d.value.type=="conversation"?(s(!0),a(f,{key:0},M(d.value.users,e=>(s(),a(f,null,[e.id!=u.value.id&&e.image?(s(),a("img",{key:0,src:e.image,class:"h-full w-full bg-cover object-cover",alt:""},null,8,Cl)):(s(),V(i(ie),{key:1,class:"h-full w-full text-gray-800"}))],64))),256)):(s(),a(f,{key:1},[d.value.image?(s(),a("img",{key:0,src:d.value.image,class:"h-full w-full bg-cover object-cover",alt:""},null,8,$l)):(s(),V(i(ue),{key:1,class:"h-full w-full text-gray-800"}))],64))]),t("div",null,[t("h1",jl,[d.value.type=="conversation"?(s(!0),a(f,{key:0},M(d.value.users,e=>(s(),a(f,null,[e.id!=u.value.id?(s(),a("span",zl,p(e.firstname),1)):h("",!0)],64))),256)):(s(),a(f,{key:1},[d.value.name?(s(),a("span",Fl,p(d.value.name),1)):(s(),a("span",Sl,"Sans nom"))],64))]),t("p",Bl,[d.value.type=="conversation"?(s(!0),a(f,{key:0},M(d.value.users,e=>(s(),a(f,null,[e.id!=u.value.id?(s(),a("span",El,p(e.email),1)):h("",!0)],64))),256)):(s(!0),a(f,{key:1},M(d.value.users,e=>(s(),a("span",null,p(e.firstname)+",",1))),256))])])]),t("button",{type:"button",onClick:o[5]||(o[5]=()=>{r.editMessage||(r.option=!r.option)}),class:"rounded p-0.5 hover:bg-gray-100"},[g(i(pt),{class:"h-8 w-8 text-gray-900"})]),S(t("div",{ref_key:"optionBlock",ref:me,class:"items-scretch absolute top-[80%] right-5 z-20 flex min-w-[80px] flex-col justify-start overflow-hidden rounded bg-white shadow"},[d.value.type!="group"?(s(),a("button",{key:0,onClick:We,type:"button",class:"text-block flex items-center gap-1 p-2 hover:bg-gray-100"},[t("span",null,[g(i(mt),{class:"h-4 w-4"})]),Ll])):h("",!0),h("",!0),t("button",{type:"button",onClick:Ge,class:"flex items-center gap-1 p-2 text-red-500 hover:bg-gray-100"},[t("span",null,[g(i(Z),{class:"h-4 w-4"})]),Dl])],512),[[H,r.option]])])):h("",!0),t("div",{ref_key:"chatDiv",ref:Y,class:"no-scrollbar mx-auto flex w-full grow flex-col-reverse items-center justify-center overflow-scroll p-4 md:max-w-[70%]"},[t("div",Hl,[S(t("div",{ref_key:"optionMessageBlock",ref:J,class:"items-scretch fixed z-50 flex min-w-[100px] flex-col justify-start overflow-hidden rounded bg-white shadow"},[k.value&&k.value.user.id==u.value.id?(s(),a("button",{key:0,type:"button",onClick:Ye,class:"flex items-center gap-1 p-2 text-black hover:bg-gray-100"},[t("span",null,[g(i(ht),{class:"h-4 w-4"})]),Ul])):h("",!0),t("button",{type:"button",onClick:Je,class:"flex items-center gap-1 p-2 text-black hover:bg-gray-100"},[t("span",null,[g(i(ft),{class:"h-4 w-4"})]),Al]),t("button",{type:"button",onClick:Pe,class:"flex items-center gap-1 p-2 text-red-500 hover:bg-gray-100"},[t("span",null,[g(i(Z),{class:"h-4 w-4"})]),Tl])],512),[[H,r.optionMessage&&!r.editMessage]]),d.value&&Me.value.length!=[]?(s(!0),a(f,{key:0},M(Me.value,(e,b)=>(s(),a("div",{key:b,class:"w-full"},[t("div",{class:_(["sticky top-0 my-4 flex items-center justify-center",[r.editMessage?"blur":""]])},[t("span",Rl,p(L(e[0].date,!0)),1)],2),(s(!0),a(f,null,M(e,(n,I)=>(s(),a("div",{key:n.id,class:_(["relative mb-2 flex w-full flex-col",[n.user.id==u.value.id?"items-end":"items-start"]])},[t("div",{onContextmenu:Te(E=>tt(E,n),["prevent"]),class:_(["relative block max-w-[90%] whitespace-pre-line break-all p-2 text-xs leading-normal tracking-wider shadow",[n.user.id==u.value.id&&r.editMessage&&k.value&&k.value.id!=n.id?"rounded-l-lg rounded-tr-lg bg-primary-blue text-white blur":n.user.id!=u.value.id&&r.editMessage?"rounded-r-lg rounded-bl-lg bg-white text-black blur":n.user.id==u.value.id?"rounded-l-lg rounded-tr-lg bg-primary-blue text-white":"rounded-r-lg rounded-bl-lg bg-white text-black"]])},[n.type=="image"?(s(),a("a",{key:0,href:n.attachement_path,download:n.attachement_name,class:"group relative mb-2 block min-h-[150px] min-w-[150px] overflow-hidden rounded"},[t("span",Il,[t("span",Kl,[g(i(He),{class:"h-5 w-5"})]),Nl]),t("img",{src:n.attachement_path,class:"max-h-[300px]",alt:""},null,8,ql),t("span",Yl,[t("span",Jl,p(n.attachement_name),1),t("span",Pl,p(n.attachement_size),1)])],8,Ol)):h("",!0),n.type=="file"?(s(),a("a",{key:1,href:n.attachement_path,download:n.attachement_name,class:"group relative mb-2 flex w-[300px] items-stretch justify-start overflow-hidden rounded bg-white/25"},[t("span",Gl,[t("span",Ql,[g(i(He),{class:"h-5 w-5"})]),Xl]),t("div",Zl,[t("span",null,p(n.attachement_name.split(".").pop()),1)]),t("div",ea,[t("span",ta,p(n.attachement_name),1),t("span",sa,p(n.attachement_size),1)])],8,Wl)):h("",!0),t("span",la,p(n.message),1),t("span",aa,[t("span",{class:_(["block h-2 w-2 rounded-full",[n.is_send?n.is_read?"bg-green-500":"bg-gray-300  ":"bg-red-500"]])},null,2),t("span",oa,p(L(n.date,!1)),1),n.is_edit?(s(),a("span",na,"Modifi\xE9")):h("",!0)])],42,Vl),k.value&&k.value.id==n.id&&r.editMessage?(s(),a("div",ra,[g(i(Ae),{onClick:o[6]||(o[6]=()=>{r.emoji=!r.emoji}),class:"absolute bottom-2 left-1 h-6 w-6 cursor-pointer text-gray-700"}),S(t("textarea",{ref_for:!0,ref_key:"textareaEdit",ref:fe,placeholder:"Your message...","onUpdate:modelValue":E=>k.value.message=E,onInput:o[7]||(o[7]=E=>je(E.target.value)),onKeydown:o[8]||(o[8]=Le(E=>et(E),["enter"])),rows:be.value,class:"w-full resize-none rounded-xl border border-gray-300 bg-white px-8 py-2 text-xs text-gray-900 shadow transition-all focus:border-primary-blue focus:ring-primary-blue",cols:"50"},null,40,ia),[[q,k.value.message]]),t("button",{type:"button",onClick:o[9]||(o[9]=E=>we()),class:"absolute right-1 bottom-2 rounded-full bg-primary-blue p-1 text-white"},[i(z)==1?(s(),a("span",da,[g(he,{size:"small"})])):(s(),a("span",ua,[g(i(Ue),{class:"h-4 w-4"})]))])])):h("",!0)],2))),128))]))),128)):h("",!0)])],512),S(t("div",ca,[t("div",ha,[t("input",{type:"file",id:"pickimage",class:"hidden",accept:"image/*",onChange:o[10]||(o[10]=e=>st(e)),disabled:r.editMessage},null,40,ga),t("input",{type:"file",id:"pickfile",class:"hidden",onChange:o[11]||(o[11]=e=>lt(e)),disabled:r.editMessage},null,40,pa),t("label",{for:"pickimage",class:_(["mb-1 cursor-pointer rounded-full bg-white p-2 shadow",[r.editMessage?"blur":""]])},[t("span",null,[g(i(de),{class:"h-4 w-4 text-gray-500 md:h-5 md:w-5"})])],2),t("label",{for:"pickfile",class:_(["mb-1 cursor-pointer rounded-full bg-white p-2 shadow",[r.editMessage?"blur":""]])},[t("span",null,[g(i(ce),{class:"h-4 w-4 text-gray-500 md:h-5 md:w-5"})])],2),t("div",fa,[c.attachement?(s(),a("div",{key:0,class:_(["mb-0.5 flex w-full items-stretch overflow-hidden rounded bg-white/60",[r.editMessage?"blur":""]])},[t("div",ma,[c.type=="image"?(s(),a("img",{key:0,class:"h-full w-full object-cover",src:c.attachement_path,alt:""},null,8,va)):(s(),a("div",ba,ya))]),t("div",wa,[t("h4",xa,p(c.attachement_name),1),t("p",ka,p(c.attachement_size),1)]),t("button",{type:"button",onClick:o[12]||(o[12]=e=>N(!0)),class:"flex w-10 cursor-pointer items-center justify-center rounded bg-white"},[g(i(gt),{class:"h-5 w-5 text-primary-blue"})])],2)):h("",!0),S(t("div",{ref_key:"emojiBlock",ref:se,class:"emojiBlock absolute bottom-[110%] z-40 min-h-[100px] min-w-[100px] overflow-hidden rounded-xl bg-white shadow"},Ca,512),[[H,r.emoji]]),g(i(Ae),{onClick:o[13]||(o[13]=()=>{r.editMessage||(r.emoji=!r.emoji)}),class:_(["absolute bottom-3 left-2 h-5 w-5 cursor-pointer text-gray-500",[r.editMessage?"blur":""]])},null,8,["class"]),S(t("textarea",{ref_key:"textarea",ref:pe,rows:ve.value,onKeydown:Le(Xe,["enter"]),"onUpdate:modelValue":o[14]||(o[14]=e=>c.message=e),onInput:Ze,disabled:r.editMessage,class:_(["mr-2 block w-full resize-none rounded-lg border border-gray-300 bg-white py-2.5 pr-2.5 pl-8 text-sm text-gray-900 shadow transition-all focus:border-primary-blue focus:ring-primary-blue",[r.editMessage?"blur":""]]),placeholder:"Your message..."},null,42,$a),[[q,c.message]])]),t("button",{class:_([[r.editMessage?"blur":""],"mb-0.5 flex h-8 w-8 flex-shrink-0 cursor-pointer items-center justify-center rounded-full bg-primary-blue text-white shadow md:h-10 md:w-10"]),type:"button",onClick:o[15]||(o[15]=e=>$e()),disabled:r.editMessage},[i(z)==1?(s(),a("span",za,[g(he,{size:"small"})])):(s(),a("span",Fa,[g(i(Ue),{class:"h-5 w-5 md:h-6 md:w-6"})]))],10,ja)])],512),[[H,d.value!=null]])],512),[[H,r.chat]])])]),S(t("div",Sa,[t("div",Ba,[Ea,t("div",La,[k.value&&k.value.user.id==u.value.id?(s(),a("button",{key:0,onClick:o[16]||(o[16]=e=>xe(!0)),type:"button",class:"rounded-full border border-gray-400 bg-white px-2 py-1 text-sm hover:bg-gray-100"}," Supprimer pour tout le monde ")):h("",!0),t("button",{onClick:o[17]||(o[17]=e=>xe(!1)),type:"button",class:"rounded-full border border-gray-400 bg-white px-2 py-1 text-sm hover:bg-gray-100"}," Supprimer pour moi "),t("button",{onClick:o[18]||(o[18]=e=>r.deleteMessage=!1),type:"button",class:"rounded-full border border-gray-400 bg-white px-2 py-1 text-sm hover:bg-gray-100"}," Annuler ")])])],512),[[H,r.deleteMessage]])]))}};export{Ya as default};
